IF OBJECT_ID('[dbo].[credit_exposure_detail_whatif]') IS NULL
BEGIN
	CREATE TABLE [dbo].[credit_exposure_detail_whatif](
		[id] [int] IDENTITY(1,1) NOT NULL,
		[whatif_criteria_id] INT NOT NULL,
		[as_of_date] [datetime] NOT NULL,
		[curve_source_value_id] [int] NOT NULL,
		[Netting_Parent_Group_ID] [int] NULL,
		[Netting_Parent_Group_Name] [varchar](100) NULL,
		[Netting_Group_ID] [int] NULL,
		[Netting_Group_Name] [varchar](100) NULL,
		[Netting_Group_Detail_ID] [int] NULL,
		[fas_subsidiary_id] [int] NULL,
		[fas_strategy_id] [int] NULL,
		[fas_book_id] [int] NULL,
		[Source_Deal_Header_ID] [int] NULL,
		[Source_Counterparty_ID] [int] NULL,
		[term_start] [datetime] NULL,
		[agg_term_start] [varchar](20) NULL,
		[Final_Und_Pnl] [float] NULL,
		[Final_Dis_Pnl] [float] NULL,
		[legal_entity] [int] NULL,
		[exp_type_id] [varchar](10) NULL,
		[exp_type] [varchar](20) NULL,
		[gross_exposure] [float] NULL,
		[d_gross_exposure] [float] NULL,
		[invoice_due_date] [datetime] NULL,
		[aged_invoice_days] [float] NULL,
		[netting_counterparty_id] [int] NULL,
		[counterparty_name] [varchar](250) NULL,
		[parent_counterparty_name] [varchar](250) NULL,
		[counterparty_type] [varchar](50) NULL,
		[risk_rating] [varchar](50) NULL,
		[debt_rating] [varchar](50) NULL,
		[industry_type1] [varchar](50) NULL,
		[industry_type2] [varchar](50) NULL,
		[sic_code] [varchar](100) NULL,
		[account_status] [varchar](50) NULL,
		[currency_name] [varchar](50) NULL,
		[watch_list] [varchar](1) NULL,
		[int_ext_flag] [varchar](1) NULL,
		[tenor_limit] [int] NULL,
		[tenor_days] [int] NULL,
		[total_limit_provided] [float] NULL,
		[total_limit_received] [float] NULL,
		[net_exposure_to_us] [float] NULL,
		[net_exposure_to_them] [float] NULL,
		[total_net_exposure] [float] NULL,
		[limit_to_us_avail] [float] NULL,
		[limit_to_them_avail] [float] NULL,
		[limit_to_us_violated] [int] NULL,
		[limit_to_them_violated] [int] NULL,
		[tenor_limit_violated] [int] NULL,
		[limit_to_us_variance] [float] NULL,
		[limit_to_them_variance] [float] NULL,
		[d_net_exposure_to_us] [float] NULL,
		[d_net_exposure_to_them] [float] NULL,
		[d_total_net_exposure] [float] NULL,
		[d_limit_to_us_avail] [float] NULL,
		[d_limit_to_them_avail] [float] NULL,
		[d_limit_to_us_variance] [float] NULL,
		[d_limit_to_them_variance] [float] NULL,
		[risk_rating_id] [int] NULL,
		[debt_rating_id] [int] NULL,
		[industry_type1_id] [int] NULL,
		[industry_type2_id] [int] NULL,
		[sic_code_id] [int] NULL,
		[counterparty_type_id] [int] NULL,
		[gross_exposure_to_them] [float] NULL,
		[internal_counterparty_id] [int] NULL,
		[contract_id] [int] NULL,
		[gross_exposure_round] [float] NULL,
		[d_gross_exposure_round] [float] NULL,
		[net_exposure_to_us_round] [float] NULL,
		[net_exposure_to_them_round] [float] NULL,
		[total_net_exposure_round] [float] NULL,
		[limit_to_us_avail_round] [float] NULL,
		[limit_to_them_avail_round] [float] NULL,
		[limit_to_us_violated_round] [float] NULL,
		[limit_to_them_violated_round] [float] NULL,
		[tenor_limit_violated_round] [float] NULL,
		[limit_to_us_variance_round] [float] NULL,
		[limit_to_them_variance_round] [float] NULL,
		[d_net_exposure_to_us_round] [float] NULL,
		[d_net_exposure_to_them_round] [float] NULL,
		[d_total_net_exposure_round] [float] NULL,
		[d_limit_to_us_avail_round] [float] NULL,
		[d_limit_to_them_avail_round] [float] NULL,
		[d_limit_to_us_variance_round] [float] NULL,
		[d_limit_to_them_variance_round] [float] NULL,
		[gross_exposure_to_them_round] [float] NULL,
		[create_user] VARCHAR(50) NULL DEFAULT dbo.FNADBUser(),
		[create_ts] DATETIME NULL DEFAULT GETDATE(),
		[buy_sell_flag] [char](1) NULL,
		[commodity_id] [int] NULL,
		[physical_financial_flag] [char](1) NULL,
		[payment_date] [date] NULL,
		[trader_id] [int] NULL,
		[apply_netting_rule] [char](1) NULL,
		[ar_prior] [float] NULL,
		[ar_current] [float] NULL,
		[ap_prior] [float] NULL,
		[ap_current] [float] NULL,
		[bom_exposure_to_us] [float] NULL,
		[bom_exposure_to_them] [float] NULL,
		[d_bom_exposure_to_us] [float] NULL,
		[d_bom_exposure_to_them] [float] NULL,
		[mtm_exposure_to_us] [float] NULL,
		[mtm_exposure_to_them] [float] NULL,
		[d_mtm_exposure_to_us] [float] NULL,
		[d_mtm_exposure_to_them] [float] NULL,
		[exposure_to_us] [float] NULL,
		[exposure_to_them] [float] NULL,
		[total_exposure_to_us_round] [float] NULL,
		[total_exposure_to_them_round] [float] NULL,
		[d_exposure_to_us] [float] NULL,
		[d_exposure_to_them] [float] NULL,
		[effective_exposure_to_us] [float] NULL,
		[effective_exposure_to_them] [float] NULL,
		[effective_exposure_to_us_round] [float] NULL,
		[effective_exposure_to_them_round] [float] NULL,
		[collateral_received] [float] NULL,
		[collateral_provided] [float] NULL,
		[cash_collateral_received] [float] NULL,
		[cash_collateral_provided] [float] NULL,
		[colletral_not_used_received] [float] NULL,
		[colletral_not_used_provided] [float] NULL,
		[prepay_received] [float] NULL,
		[prepay_provided] [float] NULL,
		[limit_provided] [float] NULL,
		[limit_received] [float] NULL,
		[limit_available_to_us] [float] NULL,
		[limit_available_to_them] [float] NULL,
		[limit_available_to_us_round] [float] NULL,
		[limit_available_to_them_round] [float] NULL,
		[rounding] [float] NULL,
		[threshold_provided] [float] NULL,
		[threshold_received] [float] NULL,
		[counterparty_credit_support_amount] [float] NULL,
		[internal_credit_support_amount] [float] NULL,
		[d_effective_exposure_to_us] [float] NULL,
		[d_effective_exposure_to_them] [float] NULL
	)
END
ELSE
    PRINT 'Table credit_exposure_detail_whatif Already Exists' 