/*
 * Copy the following Code in the sql Multiline textbox.
SELECT CASE 
            WHEN spcd.asofdate_current_month = 'n' THEN 'No'
            ELSE 'Yes'
       END                       as_of_date_current_month,
       spcd.block_define_id			block_definition_id,
       sdv1.code                    block_definition,
       spcd.commodity_id,
       sc.commodity_name            commodity,
       spcd.contract_id,
       cg.contract_name             CONTRACT,
       spcd.create_ts,
       spcd.create_user,
       spcd.source_curve_def_id     curve_id,
       spcd.curve_id                curve_code,
       spcd.curve_definition,
       spcd.curve_des,
       spcd.curve_name,
       sdv10.code                   curve_tou,
       spcd.source_curve_type_value_id curve_type_id,
       sdv2.code                    curve_type,
       su1.uom_name                 display_uom_name,
       sdv3.code                    exp_calendar_name,
       dbo.FNAFormulaFormat(fe.formula, 'r') formula,
       sdv12.code                   fv_level,
       spcd.Granularity				Granularity_id,
       sdv4.code                    Granularity,
       sdv5.code                    hourly_volume_allocation,
       spcd.index_group				index_group_id,
       sdv6.code                    index_group,
       CASE 
            WHEN spcd.is_active = 'y' THEN 'Yes'
            ELSE 'No'
       END                          is_active,
       spcd.market_value_desc,
       spcd.market_value_id,
       CASE 
            WHEN spcd.obligation = 'y' THEN 'Yes'
            ELSE 'No'
       END                          obligation,
       sdv7.code                    program_scope,
       spcd1.curve_name             proxy_curve,
       spcd2.curve_name             proxy_curve_name,
       spcd3.curve_name             proxy_curve2,
       spcd4.curve_name             proxy_curve3,
       sdv11.code                   ratio_option,
       spcd5.curve_name             risk_bucket_name,
       mcmp.monte_carlo_model_parameter_name risk_factor_model,
       CASE 
            WHEN aru.role_name IS NOT NULL THEN aru.role_name
            ELSE 'All'
       END                          ROLE,
       spcd6.curve_name             settlement_curve_name,
       spcd.source_currency_id      currency_id,
       scu.currency_name            source_currency_name,
       scu1.currency_name           source_currency_to_name,
       spcd.source_system_id,
       ssd.source_system_name       source_system,
       CASE 
            WHEN ph.[entity_name] IS NOT NULL THEN ph.[entity_name]
            ELSE 'All'
       END                          Sub,
       spcdp.sub_entity_id          sub_id,
       sdv8.code                    time_zone,
       sdv9.code                    udf_block_group_name,
       su.uom_name                  uom,
       spcd.update_ts,
       spcd.update_user,
       CASE 
            WHEN fe.formula IS NULL THEN 'Non-Derived'
            ELSE 'Derived'
       END                          derived_nonderived
FROM   source_price_curve_def spcd
       LEFT JOIN static_data_value sdv1
            ON  sdv1.value_id = spcd.block_define_id
       LEFT JOIN source_commodity sc
            ON  sc.source_commodity_id = spcd.commodity_id
       LEFT JOIN contract_group cg
            ON  spcd.contract_id = cg.contract_id
       LEFT JOIN static_data_value sdv2
            ON  sdv2.value_id = spcd.source_curve_type_value_id
       LEFT JOIN source_uom su
            ON  su.source_uom_id = spcd.uom_id
       LEFT JOIN static_data_value sdv3
            ON  sdv3.value_id = spcd.exp_calendar_id
       LEFT JOIN formula_editor fe
            ON  fe.formula_id = spcd.formula_id
       LEFT JOIN static_data_value sdv4
            ON  sdv4.value_id = spcd.Granularity
       LEFT JOIN static_data_value sdv5
            ON  sdv5.value_id = spcd.hourly_volume_allocation
       LEFT JOIN static_data_value sdv6
            ON  sdv6.value_id = spcd.index_group
       LEFT JOIN static_data_value sdv7
            ON  sdv7.value_id = spcd.program_scope_value_id
       LEFT JOIN source_price_curve_def spcd1
            ON  spcd.proxy_source_curve_def_id = spcd1.source_curve_def_id
       LEFT JOIN source_price_curve_def spcd2
            ON  spcd.monthly_index = spcd2.source_curve_def_id
       LEFT JOIN source_price_curve_def spcd3
            ON  spcd.proxy_curve_id = spcd3.source_curve_def_id
       LEFT JOIN source_price_curve_def spcd4
            ON  spcd4.source_curve_def_id = spcd.proxy_curve_id3
       LEFT JOIN source_price_curve_def spcd5
            ON  spcd.risk_bucket_id = spcd5.source_curve_def_id
       LEFT JOIN monte_carlo_model_parameter mcmp
            ON  mcmp.monte_carlo_model_parameter_id = spcd.monte_carlo_model_parameter_id
       LEFT JOIN source_price_curve_def_privilege spcdp
            ON  spcdp.source_curve_def_id = spcd.source_curve_def_id
       LEFT JOIN application_security_role aru
            ON  spcdp.role_id = aru.role_id
       LEFT JOIN source_price_curve_def spcd6
            ON  spcd.settlement_curve_id = spcd6.source_curve_def_id
       LEFT JOIN source_currency scu
            ON  spcd.source_currency_id = scu.source_currency_id
       LEFT JOIN source_currency scu1
            ON  spcd.source_currency_to_id = scu1.source_currency_id
       LEFT JOIN source_system_description ssd
            ON  ssd.source_system_id = spcd.source_system_id
       LEFT JOIN portfolio_hierarchy ph
            ON  ph.entity_id = spcdp.sub_entity_id
       LEFT JOIN static_data_value sdv8
            ON  sdv8.value_id = spcd.time_zone
       LEFT JOIN static_data_value sdv9
            ON  sdv9.value_id = spcd.udf_block_group_id
       LEFT JOIN source_uom su1
            ON  su1.source_uom_id = spcd.display_uom_id
       LEFT JOIN static_data_value sdv10
            ON  sdv10.value_id = spcd.curve_tou
       LEFT JOIN static_data_value sdv11
            ON  sdv11.value_id = spcd.ratio_option
       LEFT JOIN static_data_value sdv12
            ON  sdv12.value_id = spcd.fv_level
*/
BEGIN TRY    BEGIN TRAN   
   DECLARE @report_id_data_source_dest INT       SELECT @report_id_data_source_dest = report_id   FROM report r   WHERE r.[name] = NULL
   IF EXISTS (SELECT 1               FROM data_source               WHERE [name] = 'Price Curve Def View'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))        BEGIN    UPDATE data_source    SET alias = 'PCDV', description = ''    , [tsql] = CAST('' AS VARCHAR(MAX)) + 'SELECT CASE               WHEN spcd.asofdate_current_month = ''n'' THEN ''No''              ELSE ''Yes''         END                       as_of_date_current_month,         spcd.block_define_id   block_definition_id,         sdv1.code                    block_definition,         spcd.commodity_id,         sc.commodity_name            commodity,         spcd.contract_id,         cg.contract_name             CONTRACT,         spcd.create_ts,         spcd.create_user,         spcd.source_curve_def_id     curve_id,         spcd.curve_id                curve_code,         spcd.curve_definition,         spcd.curve_des,         spcd.curve_name,         sdv10.code                   curve_tou,         spcd.source_curve_type_value_id curve_type_id,         sdv2.code                    curve_type,         su1.uom_name                 display_uom_name,         sdv3.code                    exp_calendar_name,         dbo.FNAFormulaFormat(fe.formula, ''r'') formula,         sdv12.code                   fv_level,         spcd.Granularity    Granularity_id,         sdv4.code                    Granularity,         sdv5.code                    hourly_volume_allocation,         spcd.index_group    index_group_id,         sdv6.code                    index_group,         CASE               WHEN spcd.is_active = ''y'' THEN ''Yes''              ELSE ''No''         END                          is_active,         spcd.market_value_desc,         spcd.market_value_id,         CASE               WHEN spcd.obligation = ''y'' THEN ''Yes''              ELSE ''No''         END                          obligation,         sdv7.code                    program_scope,         spcd1.curve_name             proxy_curve,         spcd2.curve_name             proxy_curve_name,         spcd3.curve_name             proxy_curve2,         spcd4.curve_name             proxy_curve3,         sdv11.code                   ratio_option,         spcd5.curve_name             risk_bucket_name,         mcmp.monte_carlo_model_parameter_name risk_factor_model,         CASE               WHEN aru.role_name IS NOT NULL THEN aru.role_name              ELSE ''All''         END                          ROLE,         spcd6.curve_name             settlement_curve_name,         spcd.source_currency_id      currency_id,         scu.currency_name            source_currency_name,         scu1.currency_name           source_currency_to_name,         spcd.source_system_id,         ssd.source_system_name       source_system,         CASE               WHEN ph.[entity_name] IS NOT NULL THEN ph.[entity_name]              ELSE ''All''         END                          Sub,         spcdp.sub_entity_id          sub_id,         sdv8.code                    time_zone,         sdv9.code                    udf_block_group_name,         su.uom_name                  uom,         spcd.update_ts,         spcd.update_user,         CASE               WHEN fe.formula IS NULL THEN ''Non-Derived''              ELSE ''Derived''         END                          derived_nonderived  FROM   source_price_curve_def spcd         LEFT JOIN static_data_value sdv1              ON  sdv1.value_id = spcd.block_define_id         LEFT JOIN source_commodity sc              ON  sc.source_commodity_id = spcd.commodity_id         LEFT JOIN contract_group cg              ON  spcd.contract_id = cg.contract_id         LEFT JOIN static_data_value sdv2              ON  sdv2.value_id = spcd.source_curve_type_value_id         LEFT JOIN source_uom su              ON  su.source_uom_id = spcd.uom_id         LEFT JOIN static_data_value sdv3              ON  sdv3.value_id = spcd.exp_calendar_id         LEFT JOIN formula_editor fe              ON  fe.formula_id = spcd.formula_id         LEFT JOIN static_data_value sdv4              ON  sdv4.value_id = spcd.Granularity         LEFT JOIN static_data_value sdv5              ON  sdv5.value_id = spcd.hourly_volume_allocation         LEFT JOIN static_data_value sdv6              ON  sdv6.value_id = spcd.index_group         LEFT JOIN static_data_value sdv7              ON  sdv7.value_id = spcd.program_scope_value_id         LEFT JOIN source_price_curve_def spcd1              ON  spcd.proxy_source_curve_def_id = spcd1.source_curve_def_id         LEFT JOIN source_price_curve_def spcd2              ON  spcd.monthly_index = spcd2.source_curve_def_id         LEFT JOIN source_price_curve_def spcd3              ON  spcd.proxy_curve_id = spcd3.source_curve_def_id         LEFT JOIN source_price_curve_def spcd4              ON  spcd4.source_curve_def_id = spcd.proxy_curve_id3         LEFT JOIN source_price_curve_def spcd5              ON  spcd.risk_bucket_id = spcd5.source_curve_def_id         LEFT JOIN monte_carlo_model_parameter mcmp              ON  mcmp.monte_carlo_model_parameter_id = spcd.monte_carlo_model_parameter_id         LEFT JOIN source_price_curve_def_privilege spcdp              ON  spcdp.source_curve_def_id = spcd.source_curve_def_id         LEFT JOIN application_security_role aru              ON  spcdp.role_id = aru.role_id         LEFT JOIN source_price_curve_def spcd6              ON  spcd.settlement_curve_id = spcd6.source_curve_def_id         LEFT JOIN source_currency scu              ON  spcd.source_currency_id = scu.source_currency_id         LEFT JOIN source_currency scu1              ON  spcd.source_currency_to_id = scu1.source_currency_id         LEFT JOIN source_system_description ssd              ON  ssd.source_system_id = spcd.source_system_id         LEFT JOIN portfolio_hierarchy ph              ON  ph.entity_id = spcdp.sub_entity_id         LEFT JOIN static_data_value sdv8              ON  sdv8.value_id = spcd.time_zone         LEFT JOIN static_data_value sdv9              ON  sdv9.value_id = spcd.udf_block_group_id         LEFT JOIN source_uom su1              ON  su1.source_uom_id = spcd.display_uom_id         LEFT JOIN static_data_value sdv10              ON  sdv10.value_id = spcd.curve_tou         LEFT JOIN static_data_value sdv11              ON  sdv11.value_id = spcd.ratio_option         LEFT JOIN static_data_value sdv12              ON  sdv12.value_id = spcd.fv_level', report_id = @report_id_data_source_dest     WHERE [name] = 'Price Curve Def View'     AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1)   END    
   IF NOT EXISTS (SELECT 1               FROM data_source               WHERE [name] = 'Price Curve Def View'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    INSERT INTO data_source([type_id], [name], [alias], [description], [tsql], report_id)    SELECT TOP 1 1 AS [type_id], 'Price Curve Def View' AS [name], 'PCDV' AS ALIAS, '' AS [description],'SELECT CASE               WHEN spcd.asofdate_current_month = ''n'' THEN ''No''              ELSE ''Yes''         END                       as_of_date_current_month,         spcd.block_define_id   block_definition_id,         sdv1.code                    block_definition,         spcd.commodity_id,         sc.commodity_name            commodity,         spcd.contract_id,         cg.contract_name             CONTRACT,         spcd.create_ts,         spcd.create_user,         spcd.source_curve_def_id     curve_id,         spcd.curve_id                curve_code,         spcd.curve_definition,         spcd.curve_des,         spcd.curve_name,         sdv10.code                   curve_tou,         spcd.source_curve_type_value_id curve_type_id,         sdv2.code                    curve_type,         su1.uom_name                 display_uom_name,         sdv3.code                    exp_calendar_name,         dbo.FNAFormulaFormat(fe.formula, ''r'') formula,         sdv12.code                   fv_level,         spcd.Granularity    Granularity_id,         sdv4.code                    Granularity,         sdv5.code                    hourly_volume_allocation,         spcd.index_group    index_group_id,         sdv6.code                    index_group,         CASE               WHEN spcd.is_active = ''y'' THEN ''Yes''              ELSE ''No''         END                          is_active,         spcd.market_value_desc,         spcd.market_value_id,         CASE               WHEN spcd.obligation = ''y'' THEN ''Yes''              ELSE ''No''         END                          obligation,         sdv7.code                    program_scope,         spcd1.curve_name             proxy_curve,         spcd2.curve_name             proxy_curve_name,         spcd3.curve_name             proxy_curve2,         spcd4.curve_name             proxy_curve3,         sdv11.code                   ratio_option,         spcd5.curve_name             risk_bucket_name,         mcmp.monte_carlo_model_parameter_name risk_factor_model,         CASE               WHEN aru.role_name IS NOT NULL THEN aru.role_name              ELSE ''All''         END                          ROLE,         spcd6.curve_name             settlement_curve_name,         spcd.source_currency_id      currency_id,         scu.currency_name            source_currency_name,         scu1.currency_name           source_currency_to_name,         spcd.source_system_id,         ssd.source_system_name       source_system,         CASE               WHEN ph.[entity_name] IS NOT NULL THEN ph.[entity_name]              ELSE ''All''         END                          Sub,         spcdp.sub_entity_id          sub_id,         sdv8.code                    time_zone,         sdv9.code                    udf_block_group_name,         su.uom_name                  uom,         spcd.update_ts,         spcd.update_user,         CASE               WHEN fe.formula IS NULL THEN ''Non-Derived''              ELSE ''Derived''         END                          derived_nonderived  FROM   source_price_curve_def spcd         LEFT JOIN static_data_value sdv1              ON  sdv1.value_id = spcd.block_define_id         LEFT JOIN source_commodity sc              ON  sc.source_commodity_id = spcd.commodity_id         LEFT JOIN contract_group cg              ON  spcd.contract_id = cg.contract_id         LEFT JOIN static_data_value sdv2              ON  sdv2.value_id = spcd.source_curve_type_value_id         LEFT JOIN source_uom su              ON  su.source_uom_id = spcd.uom_id         LEFT JOIN static_data_value sdv3              ON  sdv3.value_id = spcd.exp_calendar_id         LEFT JOIN formula_editor fe              ON  fe.formula_id = spcd.formula_id         LEFT JOIN static_data_value sdv4              ON  sdv4.value_id = spcd.Granularity         LEFT JOIN static_data_value sdv5              ON  sdv5.value_id = spcd.hourly_volume_allocation         LEFT JOIN static_data_value sdv6              ON  sdv6.value_id = spcd.index_group         LEFT JOIN static_data_value sdv7              ON  sdv7.value_id = spcd.program_scope_value_id         LEFT JOIN source_price_curve_def spcd1              ON  spcd.proxy_source_curve_def_id = spcd1.source_curve_def_id         LEFT JOIN source_price_curve_def spcd2              ON  spcd.monthly_index = spcd2.source_curve_def_id         LEFT JOIN source_price_curve_def spcd3              ON  spcd.proxy_curve_id = spcd3.source_curve_def_id         LEFT JOIN source_price_curve_def spcd4              ON  spcd4.source_curve_def_id = spcd.proxy_curve_id3         LEFT JOIN source_price_curve_def spcd5              ON  spcd.risk_bucket_id = spcd5.source_curve_def_id         LEFT JOIN monte_carlo_model_parameter mcmp              ON  mcmp.monte_carlo_model_parameter_id = spcd.monte_carlo_model_parameter_id         LEFT JOIN source_price_curve_def_privilege spcdp              ON  spcdp.source_curve_def_id = spcd.source_curve_def_id         LEFT JOIN application_security_role aru              ON  spcdp.role_id = aru.role_id         LEFT JOIN source_price_curve_def spcd6              ON  spcd.settlement_curve_id = spcd6.source_curve_def_id         LEFT JOIN source_currency scu              ON  spcd.source_currency_id = scu.source_currency_id         LEFT JOIN source_currency scu1              ON  spcd.source_currency_to_id = scu1.source_currency_id         LEFT JOIN source_system_description ssd              ON  ssd.source_system_id = spcd.source_system_id         LEFT JOIN portfolio_hierarchy ph              ON  ph.entity_id = spcdp.sub_entity_id         LEFT JOIN static_data_value sdv8              ON  sdv8.value_id = spcd.time_zone         LEFT JOIN static_data_value sdv9              ON  sdv9.value_id = spcd.udf_block_group_id         LEFT JOIN source_uom su1              ON  su1.source_uom_id = spcd.display_uom_id         LEFT JOIN static_data_value sdv10              ON  sdv10.value_id = spcd.curve_tou         LEFT JOIN static_data_value sdv11              ON  sdv11.value_id = spcd.ratio_option         LEFT JOIN static_data_value sdv12              ON  sdv12.value_id = spcd.fv_level' AS [tsql], @report_id_data_source_dest AS report_id   END    
   IF OBJECT_ID('tempdb..#data_source_column', 'U') IS NOT NULL    DROP TABLE #data_source_column    CREATE TABLE #data_source_column(column_id INT) 
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'as_of_date_current_month'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'As of Date Current Month'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'as_of_date_current_month'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'as_of_date_current_month' AS [name], 'As of Date Current Month' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'commodity'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Commodity'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'commodity'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'commodity' AS [name], 'Commodity' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'commodity_id'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Commodity ID'        , reqd_param = 0, widget_id = 2, datatype_id = 4, param_data_source = 'SELECT source_commodity_id,commodity_name FROM source_commodity', param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'commodity_id'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'commodity_id' AS [name], 'Commodity ID' AS ALIAS, 0 AS reqd_param, 2 AS widget_id, 4 AS datatype_id, 'SELECT source_commodity_id,commodity_name FROM source_commodity' AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'CONTRACT'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Contract'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'CONTRACT'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'CONTRACT' AS [name], 'Contract' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'contract_id'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Contract ID'        , reqd_param = 0, widget_id = 1, datatype_id = 4, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'contract_id'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'contract_id' AS [name], 'Contract ID' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 4 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'create_ts'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Create Ts'        , reqd_param = 0, widget_id = 6, datatype_id = 2, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 4, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'create_ts'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'create_ts' AS [name], 'Create Ts' AS ALIAS, 0 AS reqd_param, 6 AS widget_id, 2 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,4 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'create_user'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Create User'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'create_user'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'create_user' AS [name], 'Create User' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'curve_definition'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Long Description'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'curve_definition'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'curve_definition' AS [name], 'Long Description' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'curve_des'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Curve Description'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'curve_des'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'curve_des' AS [name], 'Curve Description' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'curve_name'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Curve'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'curve_name'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'curve_name' AS [name], 'Curve' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'curve_tou'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Time of Use'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'curve_tou'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'curve_tou' AS [name], 'Time of Use' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'display_uom_name'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Position UOM'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'display_uom_name'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'display_uom_name' AS [name], 'Position UOM' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'exp_calendar_name'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Expiration Calendar'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'exp_calendar_name'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'exp_calendar_name' AS [name], 'Expiration Calendar' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'formula'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Formula'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'formula'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'formula' AS [name], 'Formula' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'fv_level'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Fair Value Level'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'fv_level'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'fv_level' AS [name], 'Fair Value Level' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'Granularity'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Granularity'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'Granularity'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'Granularity' AS [name], 'Granularity' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'hourly_volume_allocation'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Hourly Break Down'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'hourly_volume_allocation'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'hourly_volume_allocation' AS [name], 'Hourly Break Down' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'index_group'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Index Group'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'index_group'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'index_group' AS [name], 'Index Group' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'is_active'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Active'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'is_active'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'is_active' AS [name], 'Active' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'market_value_desc'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Market Value Description'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'market_value_desc'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'market_value_desc' AS [name], 'Market Value Description' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'market_value_id'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Market Value ID'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'market_value_id'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'market_value_id' AS [name], 'Market Value ID' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'obligation'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Environmental Product'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'obligation'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'obligation' AS [name], 'Environmental Product' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'program_scope'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Program Scope'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'program_scope'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'program_scope' AS [name], 'Program Scope' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'ratio_option'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Ratio Option'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'ratio_option'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'ratio_option' AS [name], 'Ratio Option' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'risk_bucket_name'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Risk Bucket'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'risk_bucket_name'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'risk_bucket_name' AS [name], 'Risk Bucket' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'risk_factor_model'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Risk Factor Model'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'risk_factor_model'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'risk_factor_model' AS [name], 'Risk Factor Model' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'ROLE'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Role'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'ROLE'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'ROLE' AS [name], 'Role' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'settlement_curve_name'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Settlement Curve'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'settlement_curve_name'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'settlement_curve_name' AS [name], 'Settlement Curve' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'source_currency_name'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Source Currency'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'source_currency_name'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'source_currency_name' AS [name], 'Source Currency' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'source_currency_to_name'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Source Currency To'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'source_currency_to_name'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'source_currency_to_name' AS [name], 'Source Currency To' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'source_system_id'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Source System ID'        , reqd_param = 0, widget_id = 1, datatype_id = 4, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'source_system_id'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'source_system_id' AS [name], 'Source System ID' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 4 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'Sub'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Subsidiary'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'Sub'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'Sub' AS [name], 'Subsidiary' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'sub_id'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Subsidiary ID'        , reqd_param = 0, widget_id = 3, datatype_id = 4, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'sub_id'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'sub_id' AS [name], 'Subsidiary ID' AS ALIAS, 0 AS reqd_param, 3 AS widget_id, 4 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'time_zone'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Time Zone'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'time_zone'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'time_zone' AS [name], 'Time Zone' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'udf_block_group_name'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'User Defined Block'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'udf_block_group_name'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'udf_block_group_name' AS [name], 'User Defined Block' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'uom'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'UOM'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'uom'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'uom' AS [name], 'UOM' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'block_definition'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Block Definition'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'block_definition'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'block_definition' AS [name], 'Block Definition' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'currency_id'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Currency ID'        , reqd_param = 0, widget_id = 1, datatype_id = 4, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'currency_id'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'currency_id' AS [name], 'Currency ID' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 4 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'curve_type'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Curve Type'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'curve_type'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'curve_type' AS [name], 'Curve Type' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'proxy_curve'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Proxy Curve'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'proxy_curve'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'proxy_curve' AS [name], 'Proxy Curve' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'proxy_curve_name'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Proxy Curve Name'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'proxy_curve_name'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'proxy_curve_name' AS [name], 'Proxy Curve Name' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'proxy_curve2'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Proxy Curve 2'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'proxy_curve2'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'proxy_curve2' AS [name], 'Proxy Curve 2' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'proxy_curve3'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Proxy Curve3'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'proxy_curve3'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'proxy_curve3' AS [name], 'Proxy Curve3' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'source_system'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Source System'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'source_system'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'source_system' AS [name], 'Source System' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'update_ts'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Update TS'        , reqd_param = 0, widget_id = 6, datatype_id = 2, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 4, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'update_ts'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'update_ts' AS [name], 'Update TS' AS ALIAS, 0 AS reqd_param, 6 AS widget_id, 2 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,4 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'update_user'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Update User'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'update_user'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'update_user' AS [name], 'Update User' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'curve_code'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Curve Code'        , reqd_param = 0, widget_id = 1, datatype_id = 5, param_data_source = NULL, param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'curve_code'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'curve_code' AS [name], 'Curve Code' AS ALIAS, 0 AS reqd_param, 1 AS widget_id, 5 AS datatype_id, NULL AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'curve_id'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Curve ID'        , reqd_param = 0, widget_id = 7, datatype_id = 4, param_data_source = '10102600', param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 1    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'curve_id'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'curve_id' AS [name], 'Curve ID' AS ALIAS, 0 AS reqd_param, 7 AS widget_id, 4 AS datatype_id, '10102600' AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 1 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'derived_nonderived'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Derived/Non-Derived'        , reqd_param = 0, widget_id = 2, datatype_id = 5, param_data_source = 'SELECT ''Derived'' , ''Derived'' UNION ALL ' + CHAR(10) + 'SELECT ''Non-derived'', ''Non-derived''', param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 0, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'derived_nonderived'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'derived_nonderived' AS [name], 'Derived/Non-Derived' AS ALIAS, 0 AS reqd_param, 2 AS widget_id, 5 AS datatype_id, 'SELECT ''Derived'' , ''Derived'' UNION ALL ' + CHAR(10) + 'SELECT ''Non-derived'', ''Non-derived''' AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,0 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'curve_type_id'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Curve Type ID'        , reqd_param = 0, widget_id = 2, datatype_id = 4, param_data_source = 'SELECT value_id, code FROM static_data_value WHERE type_id = 575', param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'curve_type_id'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'curve_type_id' AS [name], 'Curve Type ID' AS ALIAS, 0 AS reqd_param, 2 AS widget_id, 4 AS datatype_id, 'SELECT value_id, code FROM static_data_value WHERE type_id = 575' AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'Granularity_id'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Granularity ID'        , reqd_param = 0, widget_id = 2, datatype_id = 4, param_data_source = 'SELECT value_id, code FROM static_data_value WHERE type_id=978', param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'Granularity_id'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'Granularity_id' AS [name], 'Granularity ID' AS ALIAS, 0 AS reqd_param, 2 AS widget_id, 4 AS datatype_id, 'SELECT value_id, code FROM static_data_value WHERE type_id=978' AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'index_group_id'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Index Group ID'        , reqd_param = 0, widget_id = 2, datatype_id = 4, param_data_source = 'SELECT value_id, code FROM static_data_value WHERE type_id = 15100', param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'index_group_id'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'index_group_id' AS [name], 'Index Group ID' AS ALIAS, 0 AS reqd_param, 2 AS widget_id, 4 AS datatype_id, 'SELECT value_id, code FROM static_data_value WHERE type_id = 15100' AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   IF EXISTS (SELECT 1               FROM data_source_column dsc               INNER JOIN data_source ds on ds.data_source_id = dsc.source_id               WHERE ds.[name] = 'Price Curve Def View'               AND dsc.name =  'block_definition_id'      AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1))   BEGIN    UPDATE dsc      SET alias = 'Block Definition ID'        , reqd_param = 0, widget_id = 2, datatype_id = 4, param_data_source = 'SELECT value_id, code FROM static_data_value WHERE type_id = 10018', param_default_value = NULL, append_filter = 1, tooltip = NULL, column_template = 2, key_column = 0    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     WHERE ds.[name] = 'Price Curve Def View'     AND dsc.name =  'block_definition_id'     AND ISNULL(report_id, -1) = ISNULL(@report_id_data_source_dest, -1)   END    ELSE   BEGIN    INSERT INTO data_source_column(source_id, [name], ALIAS, reqd_param, widget_id    , datatype_id, param_data_source, param_default_value, append_filter, tooltip, column_template, key_column)    OUTPUT INSERTED.data_source_column_id INTO #data_source_column(column_id)    SELECT TOP 1 ds.data_source_id AS source_id, 'block_definition_id' AS [name], 'Block Definition ID' AS ALIAS, 0 AS reqd_param, 2 AS widget_id, 4 AS datatype_id, 'SELECT value_id, code FROM static_data_value WHERE type_id = 10018' AS param_data_source, NULL AS param_default_value, 1 AS append_filter, NULL  AS tooltip,2 AS column_template, 0 AS key_column        FROM sys.objects o    INNER JOIN data_source ds ON ds.[name] = 'Price Curve Def View'     AND ISNULL(ds.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    LEFT JOIN report r ON r.report_id = ds.report_id     AND ds.[type_id] = 2     AND ISNULL(r.report_id , -1) = ISNULL(@report_id_data_source_dest, -1)    WHERE ds.type_id = (CASE WHEN r.report_id IS NULL THEN ds.type_id ELSE 2 END)   END       
   DELETE dsc   FROM data_source_column dsc    INNER JOIN data_source ds ON ds.data_source_id = dsc.source_id     AND ds.[name] = 'Price Curve Def View'    AND ISNULL(report_id, -1) =  ISNULL(@report_id_data_source_dest, -1)   LEFT JOIN #data_source_column tdsc ON tdsc.column_id = dsc.data_source_column_id   WHERE tdsc.column_id IS NULL   
COMMIT TRAN    END TRY   BEGIN CATCH    IF @@TRANCOUNT > 0     ROLLBACK TRAN;         DECLARE @error_msg VARCHAR(1000)                SET @error_msg = ERROR_MESSAGE()                RAISERROR (@error_msg, 16, 1);   END CATCH