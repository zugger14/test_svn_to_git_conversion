
IF OBJECT_ID('spa_formula_breakdown') IS NOT NULL
drop proc dbo.spa_formula_breakdown

GO
/*
EXEC dbo.spa_formula_breakdown 'd',1,null,
'<Root><PSRecordset><record><index>1</index><type>operator-postfix</type><subtype> </subtype><token>%</token><token_tree>|%</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>20LagCurve</token><token_tree>|20LagCurve</token_tree></record><record><index>3</index><type>operand</type><subtype>number</subtype><token>11</token><token_tree>|   |11</token_tree></record><record><index>4</index><type>operator-postfix</type><subtype> </subtype><token>%</token><token_tree>|   |%</token_tree></record><record><index>5</index><type>operand</type><subtype>number</subtype><token>2C0</token><token_tree>|   |2C0</token_tree></record><record><index>6</index><type>operator-postfix</type><subtype> </subtype><token>%</token><token_tree>|   |%</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>2C0</token><token_tree>|   |2C0</token_tree></record><record><index>8</index><type>operator-postfix</type><subtype> </subtype><token>%</token><token_tree>|   |%</token_tree></record><record><index>9</index><type>operand</type><subtype>number</subtype><token>2C0</token><token_tree>|   |2C0</token_tree></record><record><index>10</index><type>operator-postfix</type><subtype> </subtype><token>%</token><token_tree>|   |%</token_tree></record><record><index>11</index><type>operand</type><subtype>number</subtype><token>2C3</token><token_tree>|   |2C3</token_tree></record><record><index>12</index><type>operator-postfix</type><subtype> </subtype><token>%</token><token_tree>|   |%</token_tree></record><record><index>13</index><type>operand</type><subtype>number</subtype><token>2Cnull</token><token_tree>|   |2Cnull</token_tree></record><record><index>14</index><type>operator-postfix</type><subtype> </subtype><token>%</token><token_tree>|   |%</token_tree></record><record><index>15</index><type>operand</type><subtype>number</subtype><token>2C0</token><token_tree>|   |2C0</token_tree></record><record><index>16</index><type>operator-postfix</type><subtype> </subtype><token>%</token><token_tree>|   |%</token_tree></record><record><index>17</index><type>operand</type><subtype>number</subtype><token>2C1</token><token_tree>|   |2C1</token_tree></record><record><index>18</index><type>function</type><subtype>stop</subtype><token> </token><token_tree>| </token_tree></record></PSRecordset></Root>'
*/
CREATE PROCEDURE [dbo].[spa_formula_breakdown] (
	@flag varchar(1)='i', 
	@formula_id INT,
	@nested_id int=null, 
	@xmlValue NVARCHAR(MAX),
	@formula_group_id INT=NULL,
	@formula_nested_id INT=NULL
)
AS

/*
declare @flag varchar(1),@formula_id INT,@nested_id INT, @xmlValue VARCHAR(MAX),@formula_group_id INT=NULL,
@formula_nested_id INT=NULL
--SELECT * FROM formula_editor fe
select @flag='u',@formula_id=921,@nested_id=0

drop table #tmp_func
drop table #operator
drop table #operand
drop table #formula_breakdown
drop table #expession_in_argument
drop table #argument
drop table #formula_breakdown_eff

CLOSE tmp_operator
DEALLOCATE tmp_operator
CLOSE tmp_func
DEALLOCATE tmp_func

CLOSE tmp_arguments
DEALLOCATE tmp_arguments
DROP TABLE #formula_parse
DROP TABLE #tmp_func_level
DROP TABLE #index_temp
DROP TABLE #temp_range_index
DROP TABLE #temp_arguments
DROP TABLE #if_first_arg
DROP TABLE #temp_child_to_update
DROP TABLE #parent_only_one

--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>|</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>CurveM</token><token_tree>||CurveM</token_tree></record><record><index>3</index><type>operand</type><subtype>number</subtype><token>26</token><token_tree>|||26</token_tree></record><record><index>4</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>5</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>6</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>7</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>8</index><type>operand</type><subtype>number</subtype><token>1.1</token><token_tree>||1.1</token_tree></record><record><index>9</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>10</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>11</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>|</token_tree></record><record><index>12</index><type>function</type><subtype>start</subtype><token>CurveM</token><token_tree>||CurveM</token_tree></record><record><index>13</index><type>operand</type><subtype>number</subtype><token>32</token><token_tree>|||32</token_tree></record><record><index>14</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>15</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>16</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>17</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>1.01</token><token_tree>||1.01</token_tree></record><record><index>19</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>CurveM</token><token_tree>|CurveM</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>26</token><token_tree>||26</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>1.1</token><token_tree>|1.1</token_tree></record><record><index>8</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>CurveM</token><token_tree>|CurveM</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>32</token><token_tree>||32</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>13</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>14</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>15</index><type>operand</type><subtype>number</subtype><token>1.01</token><token_tree>|1.01</token_tree></record></PSRecordset></Root>'

--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>ROW</token><token_tree>|ROW</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>7</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

--(1+2*3-8)*100/6+8

--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>|</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>ROW</token><token_tree>||ROW</token_tree></record><record><index>3</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>4</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>5</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>6</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>7</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>8</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>9</index><type>operator-infix</type><subtype>math</subtype><token>/</token><token_tree>||/</token_tree></record><record><index>10</index><type>function</type><subtype>start</subtype><token>ROW</token><token_tree>||ROW</token_tree></record><record><index>11</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>12</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>13</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>14</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>15</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>16</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>17</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>18</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>19</index><type>operand</type><subtype>number</subtype><token>100</token><token_tree>|100</token_tree></record></PSRecordset></Root>'

----2/3*4-1+6
--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|2</token_tree></record><record><index>2</index><type>operator-infix</type><subtype>math</subtype><token>/</token><token_tree>|/</token_tree></record><record><index>3</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>|3</token_tree></record><record><index>4</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>5</index><type>operand</type><subtype>number</subtype><token>4</token><token_tree>|4</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|1</token_tree></record><record><index>8</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>9</index><type>operand</type><subtype>number</subtype><token>6</token><token_tree>|6</token_tree></record></PSRecordset></Root>'


-------CurveM(26,NULL)*1.1-CurveM(32,NULL)*1.01
--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>CurveM</token><token_tree>|CurveM</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>26</token><token_tree>||26</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>1.1</token><token_tree>|1.1</token_tree></record><record><index>8</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>CurveM</token><token_tree>|CurveM</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>32</token><token_tree>||32</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>13</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>14</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>15</index><type>operand</type><subtype>number</subtype><token>1.01</token><token_tree>|1.01</token_tree></record></PSRecordset></Root>'


----3. CurveM(26,NULL)*-2
--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>CurveM</token><token_tree>|CurveM</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>26</token><token_tree>||26</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>7</index><type>operator-prefix</type><subtype></subtype><token>-</token><token_tree>|-</token_tree></record><record><index>8</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|2</token_tree></record></PSRecordset></Root>'

----''if(''''8<9'''',1adiha_add2adiha_add3,2-1adiha_add3adiha_add6)''
--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>if</token><token_tree>|if</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>8</token><token_tree>||8</token_tree></record><record><index>3</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>||adiha_lessthan</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>9</token><token_tree>||9</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>6</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>7</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>||adiha_add</token_tree></record><record><index>8</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>9</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>||adiha_add</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||3</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>13</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>||-</token_tree></record><record><index>14</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>15</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>||adiha_add</token_tree></record><record><index>16</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||3</token_tree></record><record><index>17</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>||adiha_add</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>6</token><token_tree>||6</token_tree></record><record><index>19</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

------if(''''1adiha_add2-8<9adiha_add1'''',1,2)
--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>if</token><token_tree>|if</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>3</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>||adiha_add</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>5</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>||-</token_tree></record><record><index>6</index><type>operand</type><subtype>number</subtype><token>8</token><token_tree>||8</token_tree></record><record><index>7</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>||adiha_lessthan</token_tree></record><record><index>8</index><type>operand</type><subtype>number</subtype><token>9</token><token_tree>||9</token_tree></record><record><index>9</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>||adiha_add</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>13</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>14</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>15</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'


----if('(1+2-8)<(9+1)',1,2)
--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>if</token><token_tree>|if</token_tree></record><record><index>2</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>3</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>4</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|||adiha_add</token_tree></record><record><index>5</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|||-</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>8</token><token_tree>|||8</token_tree></record><record><index>8</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>9</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>||adiha_lessthan</token_tree></record><record><index>10</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>11</index><type>operand</type><subtype>number</subtype><token>9</token><token_tree>|||9</token_tree></record><record><index>12</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|||adiha_add</token_tree></record><record><index>13</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>14</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>15</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>16</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>17</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>19</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>' 

------IF(''''(1adiha_add2-8)<((9adiha_add1))'''',1,2)
--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>3</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>4</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|||adiha_add</token_tree></record><record><index>5</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|||-</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>8</token><token_tree>|||8</token_tree></record><record><index>8</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>9</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>||adiha_lessthan</token_tree></record><record><index>10</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>11</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>|||</token_tree></record><record><index>12</index><type>operand</type><subtype>number</subtype><token>9</token><token_tree>||||9</token_tree></record><record><index>13</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>||||adiha_add</token_tree></record><record><index>14</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||||1</token_tree></record><record><index>15</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>16</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>17</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>19</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>20</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>21</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>' 


----IF(''''(1adiha_add2-8)<((9adiha_add1))'''',1,2)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>3</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>4</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|||adiha_add</token_tree></record><record><index>5</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|||-</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>8</token><token_tree>|||8</token_tree></record><record><index>8</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>9</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>||adiha_lessthan</token_tree></record><record><index>10</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>11</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>|||</token_tree></record><record><index>12</index><type>operand</type><subtype>number</subtype><token>9</token><token_tree>||||9</token_tree></record><record><index>13</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>||||adiha_add</token_tree></record><record><index>14</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||||1</token_tree></record><record><index>15</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>16</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>17</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>19</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>20</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>21</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>' 

-------IF(''''1adiha_add2-8<((9adiha_add1))'''',1,2)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>3</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>||adiha_add</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>5</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>||-</token_tree></record><record><index>6</index><type>operand</type><subtype>number</subtype><token>8</token><token_tree>||8</token_tree></record><record><index>7</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>||adiha_lessthan</token_tree></record><record><index>8</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>9</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>|||</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>9</token><token_tree>||||9</token_tree></record><record><index>11</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>||||adiha_add</token_tree></record><record><index>12</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||||1</token_tree></record><record><index>13</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>14</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>15</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>16</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>17</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>19</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

-------abs(1adiha_add2)
--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>abs</token><token_tree>|abs</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>3</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>||adiha_add</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>5</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'


-------abs(abs(1)adiha_addabs(2))
--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>abs</token><token_tree>|abs</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>abs</token><token_tree>||abs</token_tree></record><record><index>3</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>4</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>5</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>||adiha_add</token_tree></record><record><index>6</index><type>function</type><subtype>start</subtype><token>abs</token><token_tree>||abs</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>8</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>9</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

---------CurveM(26,NULL)*1.1-CurveM(32,NULL)*1.01*CurveM(32,NULL)
--SET @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>CurveM</token><token_tree>|CurveM</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>26</token><token_tree>||26</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>1.1</token><token_tree>|1.1</token_tree></record><record><index>8</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>CurveM</token><token_tree>|CurveM</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>32</token><token_tree>||32</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>13</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>14</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>15</index><type>operand</type><subtype>number</subtype><token>1.01</token><token_tree>|1.01</token_tree></record><record><index>16</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>17</index><type>function</type><subtype>start</subtype><token>CurveM</token><token_tree>|CurveM</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>32</token><token_tree>||32</token_tree></record><record><index>19</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>20</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>21</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'






-----CurveM(26,NULL)*1.1-CurveM(32,NULL)*1.01 -CurveM(32,NULL)*1.01
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>CurveM</token><token_tree>|CurveM</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>26</token><token_tree>||26</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>1.1</token><token_tree>|1.1</token_tree></record><record><index>8</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>CurveM</token><token_tree>|CurveM</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>32</token><token_tree>||32</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>13</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>14</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>15</index><type>operand</type><subtype>number</subtype><token>1.01</token><token_tree>|1.01</token_tree></record><record><index>16</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>17</index><type>function</type><subtype>start</subtype><token>CurveM</token><token_tree>|CurveM</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>32</token><token_tree>||32</token_tree></record><record><index>19</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>20</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>21</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>22</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>23</index><type>operand</type><subtype>number</subtype><token>1.01</token><token_tree>|1.01</token_tree></record></PSRecordset></Root>'

-----IF(''''AND(FieldValue(300907)=>0.6,FieldValue(300907)<=0.7)'''',ContractPriceValue(688,NULL,NULL),IF(''''AND(FieldValue(300907)>0.7,FieldValue(300907)<=0.8)'''',ContractPriceValue(708,NULL,NULL),0))adiha_add IF(''''AND(FieldValue(300906)>34,FieldValue(300906)<=34.99)'''',FieldValue(300941)*2, IF(''''AND(FieldValue(300906)>33,FieldValue(300906)<=33.99)'''',FieldValue(300941), IF(''''AND(FieldValue(300906)=>31,FieldValue(300906)<32)'''',FieldValue(300941)*(0-1), IF(''''AND(FieldValue(300906)=>30,FieldValue(300906)<31)'''',FieldValue(300941)*(0-2),0)))) adiha_addAverageCurveValue(UDFValue(-5621))*UDFValue(-5619)/UDFValue(-5615)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>3</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>5</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>logical</subtype><token>=</token><token_tree>|||=</token_tree></record><record><index>7</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>8</index><type>operand</type><subtype>number</subtype><token>0.6</token><token_tree>|||0.6</token_tree></record><record><index>9</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>10</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>11</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>12</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>13</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>14</index><type>operand</type><subtype>number</subtype><token>0.7</token><token_tree>|||0.7</token_tree></record><record><index>15</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>16</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>17</index><type>function</type><subtype>start</subtype><token>ContractPriceValue</token><token_tree>||ContractPriceValue</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>688</token><token_tree>|||688</token_tree></record><record><index>19</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>20</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>21</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>22</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>23</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>24</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>25</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>||IF</token_tree></record><record><index>26</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>|||AND</token_tree></record><record><index>27</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||||FieldValue</token_tree></record><record><index>28</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>|||||300907</token_tree></record><record><index>29</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||||</token_tree></record><record><index>30</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>||||adiha_greaterthan</token_tree></record><record><index>31</index><type>operand</type><subtype>number</subtype><token>0.7</token><token_tree>||||0.7</token_tree></record><record><index>32</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>33</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||||FieldValue</token_tree></record><record><index>34</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>|||||300907</token_tree></record><record><index>35</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||||</token_tree></record><record><index>36</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>||||adiha_lessthan=</token_tree></record><record><index>37</index><type>operand</type><subtype>number</subtype><token>0.8</token><token_tree>||||0.8</token_tree></record><record><index>38</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>39</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>40</index><type>function</type><subtype>start</subtype><token>ContractPriceValue</token><token_tree>|||ContractPriceValue</token_tree></record><record><index>41</index><type>operand</type><subtype>number</subtype><token>708</token><token_tree>||||708</token_tree></record><record><index>42</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>43</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>44</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>45</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>46</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>47</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>48</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||0</token_tree></record><record><index>49</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>50</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>51</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>52</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>53</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>54</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>55</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>56</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>57</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>58</index><type>operand</type><subtype>number</subtype><token>34</token><token_tree>|||34</token_tree></record><record><index>59</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>60</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>61</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>62</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>63</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>64</index><type>operand</type><subtype>number</subtype><token>34.99</token><token_tree>|||34.99</token_tree></record><record><index>65</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>66</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>67</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>68</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>69</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>70</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>71</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>72</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>73</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>||IF</token_tree></record><record><index>74</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>|||AND</token_tree></record><record><index>75</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||||FieldValue</token_tree></record><record><index>76</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>|||||300906</token_tree></record><record><index>77</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||||</token_tree></record><record><index>78</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>||||adiha_greaterthan</token_tree></record><record><index>79</index><type>operand</type><subtype>number</subtype><token>33</token><token_tree>||||33</token_tree></record><record><index>80</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>81</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||||FieldValue</token_tree></record><record><index>82</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>|||||300906</token_tree></record><record><index>83</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||||</token_tree></record><record><index>84</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>||||adiha_lessthan=</token_tree></record><record><index>85</index><type>operand</type><subtype>number</subtype><token>33.99</token><token_tree>||||33.99</token_tree></record><record><index>86</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>87</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>88</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>89</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>||||300941</token_tree></record><record><index>90</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>91</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>92</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|||IF</token_tree></record><record><index>93</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||||AND</token_tree></record><record><index>94</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||||FieldValue</token_tree></record><record><index>95</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||||300906</token_tree></record><record><index>96</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||||</token_tree></record><record><index>97</index><type>operator-infix</type><subtype>logical</subtype><token>=</token><token_tree>|||||=</token_tree></record><record><index>98</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||||adiha_greaterthan</token_tree></record><record><index>99</index><type>operand</type><subtype>number</subtype><token>31</token><token_tree>|||||31</token_tree></record><record><index>100</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||||,</token_tree></record><record><index>101</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||||FieldValue</token_tree></record><record><index>102</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||||300906</token_tree></record><record><index>103</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||||</token_tree></record><record><index>104</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||||adiha_lessthan</token_tree></record><record><index>105</index><type>operand</type><subtype>number</subtype><token>32</token><token_tree>|||||32</token_tree></record><record><index>106</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||||</token_tree></record><record><index>107</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>108</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||||FieldValue</token_tree></record><record><index>109</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||||300941</token_tree></record><record><index>110</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||||</token_tree></record><record><index>111</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||||*</token_tree></record><record><index>112</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||||</token_tree></record><record><index>113</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||||0</token_tree></record><record><index>114</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|||||-</token_tree></record><record><index>115</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||||1</token_tree></record><record><index>116</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||||</token_tree></record><record><index>117</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>118</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>||||IF</token_tree></record><record><index>119</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>|||||AND</token_tree></record><record><index>120</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||||||FieldValue</token_tree></record><record><index>121</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>|||||||300906</token_tree></record><record><index>122</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||||||</token_tree></record><record><index>123</index><type>operator-infix</type><subtype>logical</subtype><token>=</token><token_tree>||||||=</token_tree></record><record><index>124</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>||||||adiha_greaterthan</token_tree></record><record><index>125</index><type>operand</type><subtype>number</subtype><token>30</token><token_tree>||||||30</token_tree></record><record><index>126</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||||,</token_tree></record><record><index>127</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||||||FieldValue</token_tree></record><record><index>128</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>|||||||300906</token_tree></record><record><index>129</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||||||</token_tree></record><record><index>130</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>||||||adiha_lessthan</token_tree></record><record><index>131</index><type>operand</type><subtype>number</subtype><token>31</token><token_tree>||||||31</token_tree></record><record><index>132</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||||</token_tree></record><record><index>133</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||||,</token_tree></record><record><index>134</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||||FieldValue</token_tree></record><record><index>135</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>||||||300941</token_tree></record><record><index>136</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||||</token_tree></record><record><index>137</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|||||*</token_tree></record><record><index>138</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>|||||</token_tree></record><record><index>139</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||||||0</token_tree></record><record><index>140</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>||||||-</token_tree></record><record><index>141</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||||||2</token_tree></record><record><index>142</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>|||||</token_tree></record><record><index>143</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||||,</token_tree></record><record><index>144</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||||0</token_tree></record><record><index>145</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||||</token_tree></record><record><index>146</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>147</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>148</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>149</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>150</index><type>function</type><subtype>start</subtype><token>AverageCurveValue</token><token_tree>|AverageCurveValue</token_tree></record><record><index>151</index><type>function</type><subtype>start</subtype><token>UDFValue</token><token_tree>||UDFValue</token_tree></record><record><index>152</index><type>operand</type><subtype>number</subtype><token>-5621</token><token_tree>|||-5621</token_tree></record><record><index>153</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>154</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>155</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>156</index><type>function</type><subtype>start</subtype><token>UDFValue</token><token_tree>|UDFValue</token_tree></record><record><index>157</index><type>operand</type><subtype>number</subtype><token>-5619</token><token_tree>||-5619</token_tree></record><record><index>158</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>159</index><type>operator-infix</type><subtype>math</subtype><token>/</token><token_tree>|/</token_tree></record><record><index>160</index><type>function</type><subtype>start</subtype><token>UDFValue</token><token_tree>|UDFValue</token_tree></record><record><index>161</index><type>operand</type><subtype>number</subtype><token>-5615</token><token_tree>||-5615</token_tree></record><record><index>162</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

--MeterVol(GetLogicalValue(''''f_tlev'''',16),0,1,NULL)adiha_addMeterVol(GetLogicalValue(''''f_lev'''',16),0,1,NULL)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>MeterVol</token><token_tree>|MeterVol</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>GetLogicalValue</token><token_tree>||GetLogicalValue</token_tree></record><record><index>3</index><type>operand</type><subtype>range</subtype><token>f_tlev</token><token_tree>|||f_tlev</token_tree></record><record><index>4</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>5</index><type>operand</type><subtype>number</subtype><token>16</token><token_tree>|||16</token_tree></record><record><index>6</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>7</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>8</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>9</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>13</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>14</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>15</index><type>function</type><subtype>start</subtype><token>MeterVol</token><token_tree>|MeterVol</token_tree></record><record><index>16</index><type>function</type><subtype>start</subtype><token>GetLogicalValue</token><token_tree>||GetLogicalValue</token_tree></record><record><index>17</index><type>operand</type><subtype>range</subtype><token>f_lev</token><token_tree>|||f_lev</token_tree></record><record><index>18</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>19</index><type>operand</type><subtype>number</subtype><token>16</token><token_tree>|||16</token_tree></record><record><index>20</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>21</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>22</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>23</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>24</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>25</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>26</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>27</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'


------Row(1,NULL,NULL)adiha_addRow(2,NULL,NULL)adiha_addRow(3,NULL,NULL)adiha_addRow(4,NULL,NULL)adiha_addRow(5,NULL,NULL)adiha_addRow(6,NULL,NULL)adiha_addRow(7,NULL,NULL)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>7</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>8</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>13</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>14</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>15</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>16</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>17</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||3</token_tree></record><record><index>19</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>20</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>21</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>22</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>23</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>24</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>25</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>26</index><type>operand</type><subtype>number</subtype><token>4</token><token_tree>||4</token_tree></record><record><index>27</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>28</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>29</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>30</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>31</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>32</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>33</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>34</index><type>operand</type><subtype>number</subtype><token>5</token><token_tree>||5</token_tree></record><record><index>35</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>36</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>37</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>38</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>39</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>40</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>41</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>42</index><type>operand</type><subtype>number</subtype><token>6</token><token_tree>||6</token_tree></record><record><index>43</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>44</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>45</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>46</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>47</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>48</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>49</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>50</index><type>operand</type><subtype>number</subtype><token>7</token><token_tree>||7</token_tree></record><record><index>51</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>52</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>53</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>54</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>55</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'



------Row(1,NULL,NULL)*Row(2,NULL,NULL)*Row(3,NULL,NULL)*Row(4,NULL,NULL)*Row(5,NULL,NULL)*Row(6,NULL,NULL)/Row(7,NULL,NULL)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>7</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>8</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>13</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>14</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>15</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>16</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>17</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||3</token_tree></record><record><index>19</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>20</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>21</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>22</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>23</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>24</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>25</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>26</index><type>operand</type><subtype>number</subtype><token>4</token><token_tree>||4</token_tree></record><record><index>27</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>28</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>29</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>30</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>31</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>32</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>33</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>34</index><type>operand</type><subtype>number</subtype><token>5</token><token_tree>||5</token_tree></record><record><index>35</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>36</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>37</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>38</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>39</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>40</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>41</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>42</index><type>operand</type><subtype>number</subtype><token>6</token><token_tree>||6</token_tree></record><record><index>43</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>44</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>45</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>46</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>47</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>48</index><type>operator-infix</type><subtype>math</subtype><token>/</token><token_tree>|/</token_tree></record><record><index>49</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>50</index><type>operand</type><subtype>number</subtype><token>7</token><token_tree>||7</token_tree></record><record><index>51</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>52</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>53</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>54</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>55</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'


-----'IF(''''OR(Row(3,NULL,NULL)<1000,Row(2,NULL,NULL)<0)'''',-5,Round(AverageHourlyPrice(GetLogicalValue(''''elia_lng'''',15),NULL),0)*-1)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>OR</token><token_tree>||OR</token_tree></record><record><index>3</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||||3</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>7</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>8</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>9</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>10</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>11</index><type>operand</type><subtype>number</subtype><token>1000</token><token_tree>|||1000</token_tree></record><record><index>12</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>13</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>14</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||||2</token_tree></record><record><index>15</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>16</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>17</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>18</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>19</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>20</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>21</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||0</token_tree></record><record><index>22</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>23</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>24</index><type>operand</type><subtype>number</subtype><token>-5</token><token_tree>||-5</token_tree></record><record><index>25</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>26</index><type>function</type><subtype>start</subtype><token>Round</token><token_tree>||Round</token_tree></record><record><index>27</index><type>function</type><subtype>start</subtype><token>AverageHourlyPrice</token><token_tree>|||AverageHourlyPrice</token_tree></record><record><index>28</index><type>function</type><subtype>start</subtype><token>GetLogicalValue</token><token_tree>||||GetLogicalValue</token_tree></record><record><index>29</index><type>operand</type><subtype>range</subtype><token>elia_lng</token><token_tree>|||||elia_lng</token_tree></record><record><index>30</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||||,</token_tree></record><record><index>31</index><type>operand</type><subtype>number</subtype><token>15</token><token_tree>|||||15</token_tree></record><record><index>32</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||||</token_tree></record><record><index>33</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>34</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>35</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>36</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>37</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||0</token_tree></record><record><index>38</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>39</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>40</index><type>operator-prefix</type><subtype></subtype><token>-</token><token_tree>||-</token_tree></record><record><index>41</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>42</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'


----------IF(''''Row(1,NULL,NULL)<>Row(2,NULL,NULL)'''',Row(3,NULL,NULL),Row(5,NULL,NULL)*0.123)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>3</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>4</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>5</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>6</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>7</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>8</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>9</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthanadiha_greaterthan</token><token_tree>||adiha_lessthanadiha_greaterthan</token_tree></record><record><index>10</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>11</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>12</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>13</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>14</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>15</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>16</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>17</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>18</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>19</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>|||3</token_tree></record><record><index>20</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>21</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>22</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>23</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>24</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>25</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>26</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>27</index><type>operand</type><subtype>number</subtype><token>5</token><token_tree>|||5</token_tree></record><record><index>28</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>29</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>30</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>31</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>32</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>33</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>34</index><type>operand</type><subtype>number</subtype><token>0.123</token><token_tree>||0.123</token_tree></record><record><index>35</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

---IF(''''Row(1,NULL,NULL)<>Row(2,NULL,NULL)'''',Row(3,NULL,NULL),Row(5,NULL,NULL))
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>3</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>4</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>5</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>6</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>7</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>8</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>9</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthanadiha_greaterthan</token><token_tree>||adiha_lessthanadiha_greaterthan</token_tree></record><record><index>10</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>11</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>12</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>13</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>14</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>15</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>16</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>17</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>18</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>19</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>|||3</token_tree></record><record><index>20</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>21</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>22</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>23</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>24</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>25</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>26</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>27</index><type>operand</type><subtype>number</subtype><token>5</token><token_tree>|||5</token_tree></record><record><index>28</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>29</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>30</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>31</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>32</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>33</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'



----MIN(Row(4,NULL,NULL),Row(7,NULL,NULL))adiha_addMAX(AverageHourlyPrice(GetLogicalValue(''''elia_lng'''',15),NULL),AverageHourlyPrice(GetLogicalValue(''''elia_shrt'''',15),NULL)) 
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>MIN</token><token_tree>|MIN</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>3</index><type>operand</type><subtype>number</subtype><token>4</token><token_tree>|||4</token_tree></record><record><index>4</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>5</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>6</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>7</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>8</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>9</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>10</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>11</index><type>operand</type><subtype>number</subtype><token>7</token><token_tree>|||7</token_tree></record><record><index>12</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>13</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>14</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>15</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>16</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>17</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>18</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>19</index><type>function</type><subtype>start</subtype><token>MAX</token><token_tree>|MAX</token_tree></record><record><index>20</index><type>function</type><subtype>start</subtype><token>AverageHourlyPrice</token><token_tree>||AverageHourlyPrice</token_tree></record><record><index>21</index><type>function</type><subtype>start</subtype><token>GetLogicalValue</token><token_tree>|||GetLogicalValue</token_tree></record><record><index>22</index><type>operand</type><subtype>range</subtype><token>elia_lng</token><token_tree>||||elia_lng</token_tree></record><record><index>23</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>24</index><type>operand</type><subtype>number</subtype><token>15</token><token_tree>||||15</token_tree></record><record><index>25</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>26</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>27</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>28</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>29</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>30</index><type>function</type><subtype>start</subtype><token>AverageHourlyPrice</token><token_tree>||AverageHourlyPrice</token_tree></record><record><index>31</index><type>function</type><subtype>start</subtype><token>GetLogicalValue</token><token_tree>|||GetLogicalValue</token_tree></record><record><index>32</index><type>operand</type><subtype>range</subtype><token>elia_shrt</token><token_tree>||||elia_shrt</token_tree></record><record><index>33</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>34</index><type>operand</type><subtype>number</subtype><token>15</token><token_tree>||||15</token_tree></record><record><index>35</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>36</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>37</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>38</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>39</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'




-----Row(1,NULL,NULL)adiha_addRow(2,NULL,NULL)-Row(3,NULL,NULL)-Row(4,NULL,NULL)-Row(5,NULL,NULL)*0.1
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>7</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>8</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>13</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>14</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>15</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>16</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>17</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||3</token_tree></record><record><index>19</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>20</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>21</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>22</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>23</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>24</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>25</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>26</index><type>operand</type><subtype>number</subtype><token>4</token><token_tree>||4</token_tree></record><record><index>27</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>28</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>29</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>30</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>31</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>32</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>33</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>34</index><type>operand</type><subtype>number</subtype><token>5</token><token_tree>||5</token_tree></record><record><index>35</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>36</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>37</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>38</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>39</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>40</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>41</index><type>operand</type><subtype>number</subtype><token>0.1</token><token_tree>|0.1</token_tree></record></PSRecordset></Root>'


----IF(''''OR(Row(3,NULL,NULL)<1000,Row(2,NULL,NULL)<0)'''',Row(1,NULL,NULL),Round(AverageHourlyPrice(GetLogicalValue(''''elia_lng'''',15),NULL)*-0.5,2))
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>OR</token><token_tree>||OR</token_tree></record><record><index>3</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||||3</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>7</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>8</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>9</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>10</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>11</index><type>operand</type><subtype>number</subtype><token>1000</token><token_tree>|||1000</token_tree></record><record><index>12</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>13</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>14</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||||2</token_tree></record><record><index>15</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>16</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>17</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>18</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>19</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>20</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>21</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||0</token_tree></record><record><index>22</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>23</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>24</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>25</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>26</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>27</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>28</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>29</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>30</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>31</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>32</index><type>function</type><subtype>start</subtype><token>Round</token><token_tree>||Round</token_tree></record><record><index>33</index><type>function</type><subtype>start</subtype><token>AverageHourlyPrice</token><token_tree>|||AverageHourlyPrice</token_tree></record><record><index>34</index><type>function</type><subtype>start</subtype><token>GetLogicalValue</token><token_tree>||||GetLogicalValue</token_tree></record><record><index>35</index><type>operand</type><subtype>range</subtype><token>elia_lng</token><token_tree>|||||elia_lng</token_tree></record><record><index>36</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||||,</token_tree></record><record><index>37</index><type>operand</type><subtype>number</subtype><token>15</token><token_tree>|||||15</token_tree></record><record><index>38</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||||</token_tree></record><record><index>39</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>40</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>41</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>42</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|||*</token_tree></record><record><index>43</index><type>operator-prefix</type><subtype></subtype><token>-</token><token_tree>|||-</token_tree></record><record><index>44</index><type>operand</type><subtype>number</subtype><token>0.5</token><token_tree>|||0.5</token_tree></record><record><index>45</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>46</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>47</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>48</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

---IF(''''OR(Row(3,NULL,NULL)>1000,Row(2,NULL,NULL)<0)'''',Row(1,NULL,NULL)*102*-0.15,Row(2,NULL,NULL)-Row(3,NULL,NULL))
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>OR</token><token_tree>||OR</token_tree></record><record><index>3</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||||3</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>7</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>8</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>9</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>10</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>11</index><type>operand</type><subtype>number</subtype><token>1000</token><token_tree>|||1000</token_tree></record><record><index>12</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>13</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>14</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||||2</token_tree></record><record><index>15</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>16</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>17</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>18</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>19</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>20</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>21</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||0</token_tree></record><record><index>22</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>23</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>24</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>25</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>26</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>27</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>28</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>29</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>30</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>31</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>32</index><type>operand</type><subtype>number</subtype><token>102</token><token_tree>||102</token_tree></record><record><index>33</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>34</index><type>operator-prefix</type><subtype></subtype><token>-</token><token_tree>||-</token_tree></record><record><index>35</index><type>operand</type><subtype>number</subtype><token>0.15</token><token_tree>||0.15</token_tree></record><record><index>36</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>37</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>38</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>39</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>40</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>41</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>42</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>43</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>44</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>||-</token_tree></record><record><index>45</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>46</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>|||3</token_tree></record><record><index>47</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>48</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>49</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>50</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>51</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>52</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'


----Row(1,NULL,NULL)adiha_addRow(2,NULL,NULL)-Row(3,NULL,NULL)-Row(4,NULL,NULL)-Row(5,NULL,NULL)*0.1
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>7</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>8</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>13</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>14</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>15</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>16</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>17</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||3</token_tree></record><record><index>19</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>20</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>21</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>22</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>23</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>24</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>25</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>26</index><type>operand</type><subtype>number</subtype><token>4</token><token_tree>||4</token_tree></record><record><index>27</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>28</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>29</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>30</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>31</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>32</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>33</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>34</index><type>operand</type><subtype>number</subtype><token>5</token><token_tree>||5</token_tree></record><record><index>35</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>36</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>37</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>38</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>39</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>40</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>41</index><type>operand</type><subtype>number</subtype><token>0.1</token><token_tree>|0.1</token_tree></record></PSRecordset></Root>' 

----Row(1,NULL,NULL)adiha_addrow(2,NULL,NULL)-Row(3,NULL,NULL)-Row(4,NULL,NULL)-(Row(5,NULL,NULL)*0.1)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>7</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>8</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>row</token><token_tree>|row</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>13</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>14</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>15</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>16</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>17</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||3</token_tree></record><record><index>19</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>20</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>21</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>22</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>23</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>24</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>25</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>26</index><type>operand</type><subtype>number</subtype><token>4</token><token_tree>||4</token_tree></record><record><index>27</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>28</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>29</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>30</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>31</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>32</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>33</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>|</token_tree></record><record><index>34</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>35</index><type>operand</type><subtype>number</subtype><token>5</token><token_tree>|||5</token_tree></record><record><index>36</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>37</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>38</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>39</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>40</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>41</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>42</index><type>operand</type><subtype>number</subtype><token>0.1</token><token_tree>||0.1</token_tree></record><record><index>43</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'


-----Row(1,NULL,NULL)adiha_addRow(2,NULL,NULL)adiha_addRow(3,NULL,NULL)adiha_addRow(4,NULL,NULL)adiha_addRow(5,NULL,NULL)*0.1
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>7</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>8</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>13</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>14</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>15</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>16</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>17</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||3</token_tree></record><record><index>19</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>20</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>21</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>22</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>23</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>24</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>25</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>26</index><type>operand</type><subtype>number</subtype><token>4</token><token_tree>||4</token_tree></record><record><index>27</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>28</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>29</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>30</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>31</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>32</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>33</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>34</index><type>operand</type><subtype>number</subtype><token>5</token><token_tree>||5</token_tree></record><record><index>35</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>36</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>37</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>38</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>39</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>40</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>41</index><type>operand</type><subtype>number</subtype><token>0.1</token><token_tree>|0.1</token_tree></record></PSRecordset></Root>'


-----IF(''''Row(1,NULL,NULL)<>Row(2,NULL,NULL)'''',Row(3,NULL,NULL),ABS(Round(Row(5,NULL,NULL)*0.123-Row(3,NULL,NULL),2)))
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>3</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>4</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>5</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>6</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>7</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>8</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>9</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthanadiha_greaterthan</token><token_tree>||adiha_lessthanadiha_greaterthan</token_tree></record><record><index>10</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>11</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>12</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>13</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>14</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>15</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>16</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>17</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>18</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||Row</token_tree></record><record><index>19</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>|||3</token_tree></record><record><index>20</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>21</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>22</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>23</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>24</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>25</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>26</index><type>function</type><subtype>start</subtype><token>ABS</token><token_tree>||ABS</token_tree></record><record><index>27</index><type>function</type><subtype>start</subtype><token>Round</token><token_tree>|||Round</token_tree></record><record><index>28</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||||Row</token_tree></record><record><index>29</index><type>operand</type><subtype>number</subtype><token>5</token><token_tree>|||||5</token_tree></record><record><index>30</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||||,</token_tree></record><record><index>31</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||||NULL</token_tree></record><record><index>32</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||||,</token_tree></record><record><index>33</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||||NULL</token_tree></record><record><index>34</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||||</token_tree></record><record><index>35</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||||*</token_tree></record><record><index>36</index><type>operand</type><subtype>number</subtype><token>0.123</token><token_tree>||||0.123</token_tree></record><record><index>37</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>||||-</token_tree></record><record><index>38</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>||||Row</token_tree></record><record><index>39</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>|||||3</token_tree></record><record><index>40</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||||,</token_tree></record><record><index>41</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||||NULL</token_tree></record><record><index>42</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||||,</token_tree></record><record><index>43</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||||NULL</token_tree></record><record><index>44</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||||</token_tree></record><record><index>45</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>46</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||||2</token_tree></record><record><index>47</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>48</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>49</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

-----Row(1,NULL,NULL)-Row(2,NULL,NULL)adiha_addRow(3,NULL,NULL)-Row(4,NULL,NULL)-Row(5,NULL,NULL)*0.1
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>7</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>8</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>11</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>12</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>13</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>14</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>15</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>16</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>17</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||3</token_tree></record><record><index>19</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>20</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>21</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>22</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>23</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>24</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>25</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>26</index><type>operand</type><subtype>number</subtype><token>4</token><token_tree>||4</token_tree></record><record><index>27</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>28</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>29</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>30</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>31</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>32</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|-</token_tree></record><record><index>33</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>34</index><type>operand</type><subtype>number</subtype><token>5</token><token_tree>||5</token_tree></record><record><index>35</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>36</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>37</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>38</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>39</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>40</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>41</index><type>operand</type><subtype>number</subtype><token>0.1</token><token_tree>|0.1</token_tree></record></PSRecordset></Root>'


-----compare(''''<>'''',1,2)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>compare</token><token_tree>|compare</token_tree></record><record><index>2</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthanadiha_greaterthan</token><token_tree>||adiha_lessthanadiha_greaterthan</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>6</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>7</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

-----Compare(''''<'''',1,2)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>Compare</token><token_tree>|Compare</token_tree></record><record><index>2</index><type>operand</type><subtype>range</subtype><token>adiha_lessthan</token><token_tree>||adiha_lessthan</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>6</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>7</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'


--if(''''1<>2'''',1,3)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>if</token><token_tree>|if</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>3</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthanadiha_greaterthan</token><token_tree>||adiha_lessthanadiha_greaterthan</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>6</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>7</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>8</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||3</token_tree></record><record><index>9</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

----IF(''''(Row(1,NULL,NULL)adiha_addRow(2,NULL,NULL))>(Row(3,NULL,NULL)adiha_addRow(2,NULL,NULL))'''',-5,5)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>3</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||||1</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>7</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>8</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>9</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>10</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|||adiha_add</token_tree></record><record><index>11</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>12</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||||2</token_tree></record><record><index>13</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>14</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>15</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>16</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>17</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>18</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>19</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>||adiha_greaterthan</token_tree></record><record><index>20</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>21</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>22</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||||3</token_tree></record><record><index>23</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>24</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>25</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>26</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>27</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>28</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|||adiha_add</token_tree></record><record><index>29</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>30</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||||2</token_tree></record><record><index>31</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>32</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>33</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>34</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>35</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>36</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>37</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>38</index><type>operand</type><subtype>number</subtype><token>-5</token><token_tree>||-5</token_tree></record><record><index>39</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>40</index><type>operand</type><subtype>number</subtype><token>5</token><token_tree>||5</token_tree></record><record><index>41</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

------IF(''''(Row(1,NULL,NULL)adiha_addRow(2,NULL,NULL)adiha_addROW(3,NULL,NULL))>=(Row(3,NULL,NULL)adiha_addRow(2,NULL,NULL))'''',-5,5)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>3</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||||1</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>7</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>8</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>9</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>10</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|||adiha_add</token_tree></record><record><index>11</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>12</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||||2</token_tree></record><record><index>13</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>14</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>15</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>16</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>17</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>18</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|||adiha_add</token_tree></record><record><index>19</index><type>function</type><subtype>start</subtype><token>ROW</token><token_tree>|||ROW</token_tree></record><record><index>20</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||||3</token_tree></record><record><index>21</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>22</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>23</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>24</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>25</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>26</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>27</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>||adiha_greaterthan=</token_tree></record><record><index>28</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>29</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>30</index><type>operand</type><subtype>number</subtype><token>3</token><token_tree>||||3</token_tree></record><record><index>31</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>32</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>33</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>34</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>35</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>36</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|||adiha_add</token_tree></record><record><index>37</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|||Row</token_tree></record><record><index>38</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||||2</token_tree></record><record><index>39</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>40</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>41</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||||,</token_tree></record><record><index>42</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||||NULL</token_tree></record><record><index>43</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>44</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>45</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>46</index><type>operand</type><subtype>number</subtype><token>-5</token><token_tree>||-5</token_tree></record><record><index>47</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>48</index><type>operand</type><subtype>number</subtype><token>5</token><token_tree>||5</token_tree></record><record><index>49</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

-----IF(''''FieldValue(301979)=1'''',IsNull(FieldValue(-5615),1)/IsNull(FieldValue(-5619),1),1)*(AverageCurveValue(FieldValue(-5621))adiha_addFieldValue(301978))
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>3</index><type>operand</type><subtype>number</subtype><token>301979</token><token_tree>|||301979</token_tree></record><record><index>4</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>5</index><type>operator-infix</type><subtype>logical</subtype><token>=</token><token_tree>||=</token_tree></record><record><index>6</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>7</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>8</index><type>function</type><subtype>start</subtype><token>IsNull</token><token_tree>||IsNull</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>-5615</token><token_tree>||||-5615</token_tree></record><record><index>11</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>12</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>13</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>14</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>15</index><type>operator-infix</type><subtype>math</subtype><token>/</token><token_tree>||/</token_tree></record><record><index>16</index><type>function</type><subtype>start</subtype><token>IsNull</token><token_tree>||IsNull</token_tree></record><record><index>17</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>18</index><type>operand</type><subtype>number</subtype><token>-5619</token><token_tree>||||-5619</token_tree></record><record><index>19</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>20</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>21</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>22</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>23</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>24</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>25</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>26</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>27</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>|</token_tree></record><record><index>28</index><type>function</type><subtype>start</subtype><token>AverageCurveValue</token><token_tree>||AverageCurveValue</token_tree></record><record><index>29</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>30</index><type>operand</type><subtype>number</subtype><token>-5621</token><token_tree>||||-5621</token_tree></record><record><index>31</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>32</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>33</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>||adiha_add</token_tree></record><record><index>34</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>35</index><type>operand</type><subtype>number</subtype><token>301978</token><token_tree>|||301978</token_tree></record><record><index>36</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>37</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'


----IF(''''AND(FieldValue(300907)>=0.6,FieldValue(300907)<=0.7)'''',ContractPriceValue(688,NULL,NULL),0)adiha_addIF(''''AND(FieldValue(300907)>0.7,FieldValue(300907)<=0.8)'''',ContractPriceValue(708,NULL,NULL),0)adiha_addIF(''''AND(FieldValue(300906)>34,FieldValue(300906)<=34.99)'''',FieldValue(300941)*2,0)adiha_addIF(''''AND(FieldValue(300906)>33,FieldValue(300906)<=33.99)'''',FieldValue(300941),0)adiha_addIF(''''AND(FieldValue(300906)>=31,FieldValue(300906)<32)'''',FieldValue(300941)*(0-1),0)adiha_addIF(''''AND(FieldValue(300906)>=30,FieldValue(300906)<31)'''',FieldValue(300941)*(0-2),0)adiha_addAverageCurveValue(FieldValue(-5621))*IsNull(FieldValue(-5615),1)/IsNull(FieldValue(-5619),1)'
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>3</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>5</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>0.6</token><token_tree>|||0.6</token_tree></record><record><index>8</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>11</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>12</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>13</index><type>operand</type><subtype>number</subtype><token>0.7</token><token_tree>|||0.7</token_tree></record><record><index>14</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>15</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>16</index><type>function</type><subtype>start</subtype><token>ContractPriceValue</token><token_tree>||ContractPriceValue</token_tree></record><record><index>17</index><type>operand</type><subtype>number</subtype><token>688</token><token_tree>|||688</token_tree></record><record><index>18</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>19</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>20</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>21</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>22</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>23</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>24</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>25</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>26</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>27</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>28</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>29</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>30</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>31</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>32</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>33</index><type>operand</type><subtype>number</subtype><token>0.7</token><token_tree>|||0.7</token_tree></record><record><index>34</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>35</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>36</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>37</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>38</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>39</index><type>operand</type><subtype>number</subtype><token>0.8</token><token_tree>|||0.8</token_tree></record><record><index>40</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>41</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>42</index><type>function</type><subtype>start</subtype><token>ContractPriceValue</token><token_tree>||ContractPriceValue</token_tree></record><record><index>43</index><type>operand</type><subtype>number</subtype><token>708</token><token_tree>|||708</token_tree></record><record><index>44</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>45</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>46</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>47</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>48</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>49</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>50</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>51</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>52</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>53</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>54</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>55</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>56</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>57</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>58</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>59</index><type>operand</type><subtype>number</subtype><token>34</token><token_tree>|||34</token_tree></record><record><index>60</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>61</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>62</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>63</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>64</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>65</index><type>operand</type><subtype>number</subtype><token>34.99</token><token_tree>|||34.99</token_tree></record><record><index>66</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>67</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>68</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>69</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>70</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>71</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>72</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>73</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>74</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>75</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>76</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>77</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>78</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>79</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>80</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>81</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>82</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>83</index><type>operand</type><subtype>number</subtype><token>33</token><token_tree>|||33</token_tree></record><record><index>84</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>85</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>86</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>87</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>88</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>89</index><type>operand</type><subtype>number</subtype><token>33.99</token><token_tree>|||33.99</token_tree></record><record><index>90</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>91</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>92</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>93</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>94</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>95</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>96</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>97</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>98</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>99</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>100</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>101</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>102</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>103</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>104</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>105</index><type>operand</type><subtype>number</subtype><token>31</token><token_tree>|||31</token_tree></record><record><index>106</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>107</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>108</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>109</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>110</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>111</index><type>operand</type><subtype>number</subtype><token>32</token><token_tree>|||32</token_tree></record><record><index>112</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>113</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>114</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>115</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>116</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>117</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>118</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>119</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||0</token_tree></record><record><index>120</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|||-</token_tree></record><record><index>121</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>122</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>123</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>124</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>125</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>126</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>127</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>128</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>129</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>130</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>131</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>132</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>133</index><type>operand</type><subtype>number</subtype><token>30</token><token_tree>|||30</token_tree></record><record><index>134</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>135</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>136</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>137</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>138</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>139</index><type>operand</type><subtype>number</subtype><token>31</token><token_tree>|||31</token_tree></record><record><index>140</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>141</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>142</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>143</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>144</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>145</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>146</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>147</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||0</token_tree></record><record><index>148</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|||-</token_tree></record><record><index>149</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>150</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>151</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>152</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>153</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>154</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>155</index><type>function</type><subtype>start</subtype><token>AverageCurveValue</token><token_tree>|AverageCurveValue</token_tree></record><record><index>156</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>157</index><type>operand</type><subtype>number</subtype><token>-5621</token><token_tree>|||-5621</token_tree></record><record><index>158</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>159</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>160</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>161</index><type>function</type><subtype>start</subtype><token>IsNull</token><token_tree>|IsNull</token_tree></record><record><index>162</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>163</index><type>operand</type><subtype>number</subtype><token>-5615</token><token_tree>|||-5615</token_tree></record><record><index>164</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>165</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>166</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>167</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>168</index><type>operator-infix</type><subtype>math</subtype><token>/</token><token_tree>|/</token_tree></record><record><index>169</index><type>function</type><subtype>start</subtype><token>IsNull</token><token_tree>|IsNull</token_tree></record><record><index>170</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>171</index><type>operand</type><subtype>number</subtype><token>-5619</token><token_tree>|||-5619</token_tree></record><record><index>172</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>173</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>174</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>175</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'

------'IF(''''AND(FieldValue(300907)>=0.6,FieldValue(300907)<=0.7)'''',ContractPriceValue(688,NULL,NULL),0)adiha_addIF(''''AND(FieldValue(300907)>0.7,FieldValue(300907)<=0.8)'''',ContractPriceValue(708,NULL,NULL),0)adiha_addIF(''''AND(FieldValue(300906)>34,FieldValue(300906)<=34.99)'''',FieldValue(300941)*2,0)adiha_addIF(''''AND(FieldValue(300906)>33,FieldValue(300906)<=33.99)'''',FieldValue(300941),0)adiha_addIF(''''AND(FieldValue(300906)>=31,FieldValue(300906)<32)'''',FieldValue(300941)*(0-1),0)adiha_addIF(''''AND(FieldValue(300906)>=30,FieldValue(300906)<31)'''',FieldValue(300941)*(0-2),0)adiha_addAverageCurveValue(FieldValue(-5621))adiha_addFieldValue(301978)'
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>3</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>5</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>0.6</token><token_tree>|||0.6</token_tree></record><record><index>8</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>11</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>12</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>13</index><type>operand</type><subtype>number</subtype><token>0.7</token><token_tree>|||0.7</token_tree></record><record><index>14</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>15</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>16</index><type>function</type><subtype>start</subtype><token>ContractPriceValue</token><token_tree>||ContractPriceValue</token_tree></record><record><index>17</index><type>operand</type><subtype>number</subtype><token>688</token><token_tree>|||688</token_tree></record><record><index>18</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>19</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>20</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>21</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>22</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>23</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>24</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>25</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>26</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>27</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>28</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>29</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>30</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>31</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>32</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>33</index><type>operand</type><subtype>number</subtype><token>0.7</token><token_tree>|||0.7</token_tree></record><record><index>34</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>35</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>36</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>37</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>38</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>39</index><type>operand</type><subtype>number</subtype><token>0.8</token><token_tree>|||0.8</token_tree></record><record><index>40</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>41</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>42</index><type>function</type><subtype>start</subtype><token>ContractPriceValue</token><token_tree>||ContractPriceValue</token_tree></record><record><index>43</index><type>operand</type><subtype>number</subtype><token>708</token><token_tree>|||708</token_tree></record><record><index>44</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>45</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>46</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>47</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>48</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>49</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>50</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>51</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>52</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>53</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>54</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>55</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>56</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>57</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>58</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>59</index><type>operand</type><subtype>number</subtype><token>34</token><token_tree>|||34</token_tree></record><record><index>60</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>61</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>62</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>63</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>64</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>65</index><type>operand</type><subtype>number</subtype><token>34.99</token><token_tree>|||34.99</token_tree></record><record><index>66</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>67</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>68</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>69</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>70</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>71</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>72</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>73</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>74</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>75</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>76</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>77</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>78</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>79</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>80</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>81</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>82</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>83</index><type>operand</type><subtype>number</subtype><token>33</token><token_tree>|||33</token_tree></record><record><index>84</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>85</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>86</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>87</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>88</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>89</index><type>operand</type><subtype>number</subtype><token>33.99</token><token_tree>|||33.99</token_tree></record><record><index>90</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>91</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>92</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>93</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>94</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>95</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>96</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>97</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>98</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>99</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>100</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>101</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>102</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>103</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>104</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>105</index><type>operand</type><subtype>number</subtype><token>31</token><token_tree>|||31</token_tree></record><record><index>106</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>107</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>108</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>109</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>110</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>111</index><type>operand</type><subtype>number</subtype><token>32</token><token_tree>|||32</token_tree></record><record><index>112</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>113</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>114</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>115</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>116</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>117</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>118</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>119</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||0</token_tree></record><record><index>120</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|||-</token_tree></record><record><index>121</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>122</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>123</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>124</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>125</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>126</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>127</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>128</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>129</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>130</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>131</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>132</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>133</index><type>operand</type><subtype>number</subtype><token>30</token><token_tree>|||30</token_tree></record><record><index>134</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>135</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>136</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>137</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>138</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>139</index><type>operand</type><subtype>number</subtype><token>31</token><token_tree>|||31</token_tree></record><record><index>140</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>141</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>142</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>143</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>144</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>145</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>146</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>147</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||0</token_tree></record><record><index>148</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|||-</token_tree></record><record><index>149</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>150</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>151</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>152</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>153</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>154</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>155</index><type>function</type><subtype>start</subtype><token>AverageCurveValue</token><token_tree>|AverageCurveValue</token_tree></record><record><index>156</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>157</index><type>operand</type><subtype>number</subtype><token>-5621</token><token_tree>|||-5621</token_tree></record><record><index>158</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>159</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>160</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>161</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|FieldValue</token_tree></record><record><index>162</index><type>operand</type><subtype>number</subtype><token>301978</token><token_tree>||301978</token_tree></record><record><index>163</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>' 



-----IF(''''AND(FieldValue(300907)>=0.6,FieldValue(300907)<=0.7)'''',ContractPriceValue(688,NULL,NULL),0)adiha_addIF(''''AND(FieldValue(300907)>0.7,FieldValue(300907)<=0.8)'''',ContractPriceValue(708,NULL,NULL),0)adiha_addIF(''''AND(FieldValue(300906)>34,FieldValue(300906)<=34.99)'''',FieldValue(300941)*2,0)adiha_addIF(''''AND(FieldValue(300906)>33,FieldValue(300906)<=33.99)'''',FieldValue(300941),0)adiha_addIF(''''AND(FieldValue(300906)>=31,FieldValue(300906)<32)'''',FieldValue(300941),0)adiha_addIF(''''AND(FieldValue(300906)>=30,FieldValue(300906)<31)'''',FieldValue(300941)*(0-2),0)adiha_addAverageCurveValue(FieldValue(-5621))adiha_addFieldValue(301978)
---set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>3</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>5</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>0.6</token><token_tree>|||0.6</token_tree></record><record><index>8</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>11</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>12</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>13</index><type>operand</type><subtype>number</subtype><token>0.7</token><token_tree>|||0.7</token_tree></record><record><index>14</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>15</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>16</index><type>function</type><subtype>start</subtype><token>ContractPriceValue</token><token_tree>||ContractPriceValue</token_tree></record><record><index>17</index><type>operand</type><subtype>number</subtype><token>688</token><token_tree>|||688</token_tree></record><record><index>18</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>19</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>20</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>21</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>22</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>23</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>24</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>25</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>26</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>27</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>28</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>29</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>30</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>31</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>32</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>33</index><type>operand</type><subtype>number</subtype><token>0.7</token><token_tree>|||0.7</token_tree></record><record><index>34</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>35</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>36</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>37</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>38</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>39</index><type>operand</type><subtype>number</subtype><token>0.8</token><token_tree>|||0.8</token_tree></record><record><index>40</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>41</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>42</index><type>function</type><subtype>start</subtype><token>ContractPriceValue</token><token_tree>||ContractPriceValue</token_tree></record><record><index>43</index><type>operand</type><subtype>number</subtype><token>708</token><token_tree>|||708</token_tree></record><record><index>44</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>45</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>46</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>47</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>48</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>49</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>50</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>51</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>52</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>53</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>54</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>55</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>56</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>57</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>58</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>59</index><type>operand</type><subtype>number</subtype><token>34</token><token_tree>|||34</token_tree></record><record><index>60</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>61</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>62</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>63</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>64</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>65</index><type>operand</type><subtype>number</subtype><token>34.99</token><token_tree>|||34.99</token_tree></record><record><index>66</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>67</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>68</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>69</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>70</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>71</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>72</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>73</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>74</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>75</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>76</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>77</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>78</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>79</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>80</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>81</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>82</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>83</index><type>operand</type><subtype>number</subtype><token>33</token><token_tree>|||33</token_tree></record><record><index>84</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>85</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>86</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>87</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>88</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>89</index><type>operand</type><subtype>number</subtype><token>33.99</token><token_tree>|||33.99</token_tree></record><record><index>90</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>91</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>92</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>93</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>94</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>95</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>96</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>97</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>98</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>99</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>100</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>101</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>102</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>103</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>104</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>105</index><type>operand</type><subtype>number</subtype><token>31</token><token_tree>|||31</token_tree></record><record><index>106</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>107</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>108</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>109</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>110</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>111</index><type>operand</type><subtype>number</subtype><token>32</token><token_tree>|||32</token_tree></record><record><index>112</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>113</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>114</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>115</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>116</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>117</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>118</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>119</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>120</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>121</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>122</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>123</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>124</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>125</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>126</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>127</index><type>operand</type><subtype>number</subtype><token>30</token><token_tree>|||30</token_tree></record><record><index>128</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>129</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>130</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>131</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>132</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>133</index><type>operand</type><subtype>number</subtype><token>31</token><token_tree>|||31</token_tree></record><record><index>134</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>135</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>136</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>137</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>138</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>139</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>140</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>141</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||0</token_tree></record><record><index>142</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|||-</token_tree></record><record><index>143</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>144</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>145</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>146</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>147</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>148</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>149</index><type>function</type><subtype>start</subtype><token>AverageCurveValue</token><token_tree>|AverageCurveValue</token_tree></record><record><index>150</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>151</index><type>operand</type><subtype>number</subtype><token>-5621</token><token_tree>|||-5621</token_tree></record><record><index>152</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>153</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>154</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>155</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|FieldValue</token_tree></record><record><index>156</index><type>operand</type><subtype>number</subtype><token>301978</token><token_tree>||301978</token_tree></record><record><index>157</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'



---'IF(''''AND(FieldValue(300907)>=0.6,FieldValue(300907)<=0.7)'''',ContractPriceValue(688,NULL,NULL),0)adiha_addIF(''''AND(FieldValue(300907)>0.7,FieldValue(300907)<=0.8)'''',ContractPriceValue(708,NULL,NULL),0)adiha_addIF(''''AND(FieldValue(300906)>34,FieldValue(300906)<=34.99)'''',FieldValue(300941)*2,0)adiha_addIF(''''AND(FieldValue(300906)>33,FieldValue(300906)<=33.99)'''',FieldValue(300941),0)adiha_addIF(''''AND(FieldValue(300906)>=31,FieldValue(300906)<32)'''',FieldValue(300941),0)adiha_addIF(''''AND(FieldValue(300906)>=30,FieldValue(300906)<31)'''',FieldValue(300941),0)adiha_addAverageCurveValue(FieldValue(-5621))adiha_addFieldValue(301978)
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>3</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>5</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>0.6</token><token_tree>|||0.6</token_tree></record><record><index>8</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>11</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>12</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>13</index><type>operand</type><subtype>number</subtype><token>0.7</token><token_tree>|||0.7</token_tree></record><record><index>14</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>15</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>16</index><type>function</type><subtype>start</subtype><token>ContractPriceValue</token><token_tree>||ContractPriceValue</token_tree></record><record><index>17</index><type>operand</type><subtype>number</subtype><token>688</token><token_tree>|||688</token_tree></record><record><index>18</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>19</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>20</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>21</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>22</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>23</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>24</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>25</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>26</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>27</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>28</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>29</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>30</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>31</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>32</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>33</index><type>operand</type><subtype>number</subtype><token>0.7</token><token_tree>|||0.7</token_tree></record><record><index>34</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>35</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>36</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>37</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>38</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>39</index><type>operand</type><subtype>number</subtype><token>0.8</token><token_tree>|||0.8</token_tree></record><record><index>40</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>41</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>42</index><type>function</type><subtype>start</subtype><token>ContractPriceValue</token><token_tree>||ContractPriceValue</token_tree></record><record><index>43</index><type>operand</type><subtype>number</subtype><token>708</token><token_tree>|||708</token_tree></record><record><index>44</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>45</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>46</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>47</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>48</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>49</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>50</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>51</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>52</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>53</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>54</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>55</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>56</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>57</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>58</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>59</index><type>operand</type><subtype>number</subtype><token>34</token><token_tree>|||34</token_tree></record><record><index>60</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>61</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>62</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>63</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>64</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>65</index><type>operand</type><subtype>number</subtype><token>34.99</token><token_tree>|||34.99</token_tree></record><record><index>66</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>67</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>68</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>69</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>70</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>71</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>72</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>73</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>74</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>75</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>76</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>77</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>78</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>79</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>80</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>81</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>82</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>83</index><type>operand</type><subtype>number</subtype><token>33</token><token_tree>|||33</token_tree></record><record><index>84</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>85</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>86</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>87</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>88</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>89</index><type>operand</type><subtype>number</subtype><token>33.99</token><token_tree>|||33.99</token_tree></record><record><index>90</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>91</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>92</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>93</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>94</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>95</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>96</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>97</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>98</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>99</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>100</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>101</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>102</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>103</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>104</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>105</index><type>operand</type><subtype>number</subtype><token>31</token><token_tree>|||31</token_tree></record><record><index>106</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>107</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>108</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>109</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>110</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>111</index><type>operand</type><subtype>number</subtype><token>32</token><token_tree>|||32</token_tree></record><record><index>112</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>113</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>114</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>115</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>116</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>117</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>118</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>119</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>120</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>121</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>122</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>123</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>124</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>125</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>126</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>127</index><type>operand</type><subtype>number</subtype><token>30</token><token_tree>|||30</token_tree></record><record><index>128</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>129</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>130</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>131</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>132</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>133</index><type>operand</type><subtype>number</subtype><token>31</token><token_tree>|||31</token_tree></record><record><index>134</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>135</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>136</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>137</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>138</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>139</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>140</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>141</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>142</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>143</index><type>function</type><subtype>start</subtype><token>AverageCurveValue</token><token_tree>|AverageCurveValue</token_tree></record><record><index>144</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>145</index><type>operand</type><subtype>number</subtype><token>-5621</token><token_tree>|||-5621</token_tree></record><record><index>146</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>147</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>148</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>149</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|FieldValue</token_tree></record><record><index>150</index><type>operand</type><subtype>number</subtype><token>301978</token><token_tree>||301978</token_tree></record><record><index>151</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'


----IF(''''AND(FieldValue(300907)>=0.6,FieldValue(300907)<=0.7)'''',ContractPriceValue(688,NULL,NULL),0)adiha_addIF(''''AND(FieldValue(300907)>0.7,FieldValue(300907)<=0.8)'''',ContractPriceValue(708,NULL,NULL),0)adiha_addIF(''''AND(FieldValue(300906)>34,FieldValue(300906)<=34.99)'''',FieldValue(300941)*2,0)adiha_addIF(''''AND(FieldValue(300906)>33,FieldValue(300906)<=33.99)'''',FieldValue(300941),0)adiha_addIF(''''AND(FieldValue(300906)>=31,FieldValue(300906)<32)'''',FieldValue(300941)*(0-1),0)adiha_addIF(''''AND(FieldValue(300906)>=30,FieldValue(300906)<31)'''',FieldValue(300941)*(0-2),0)adiha_addAverageCurveValue(FieldValue(-5621))*IsNull(FieldValue(-5615),1)/IsNull(FieldValue(-5619),1) 
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>2</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>3</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>4</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>5</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>6</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>7</index><type>operand</type><subtype>number</subtype><token>0.6</token><token_tree>|||0.6</token_tree></record><record><index>8</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>10</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>11</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>12</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>13</index><type>operand</type><subtype>number</subtype><token>0.7</token><token_tree>|||0.7</token_tree></record><record><index>14</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>15</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>16</index><type>function</type><subtype>start</subtype><token>ContractPriceValue</token><token_tree>||ContractPriceValue</token_tree></record><record><index>17</index><type>operand</type><subtype>number</subtype><token>688</token><token_tree>|||688</token_tree></record><record><index>18</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>19</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>20</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>21</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>22</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>23</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>24</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>25</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>26</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>27</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>28</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>29</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>30</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>31</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>32</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>33</index><type>operand</type><subtype>number</subtype><token>0.7</token><token_tree>|||0.7</token_tree></record><record><index>34</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>35</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>36</index><type>operand</type><subtype>number</subtype><token>300907</token><token_tree>||||300907</token_tree></record><record><index>37</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>38</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>39</index><type>operand</type><subtype>number</subtype><token>0.8</token><token_tree>|||0.8</token_tree></record><record><index>40</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>41</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>42</index><type>function</type><subtype>start</subtype><token>ContractPriceValue</token><token_tree>||ContractPriceValue</token_tree></record><record><index>43</index><type>operand</type><subtype>number</subtype><token>708</token><token_tree>|||708</token_tree></record><record><index>44</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>45</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>46</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>47</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>|||NULL</token_tree></record><record><index>48</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>49</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>50</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>51</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>52</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>53</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>54</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>55</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>56</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>57</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>58</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>59</index><type>operand</type><subtype>number</subtype><token>34</token><token_tree>|||34</token_tree></record><record><index>60</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>61</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>62</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>63</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>64</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>65</index><type>operand</type><subtype>number</subtype><token>34.99</token><token_tree>|||34.99</token_tree></record><record><index>66</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>67</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>68</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>69</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>70</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>71</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>72</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>||2</token_tree></record><record><index>73</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>74</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>75</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>76</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>77</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>78</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>79</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>80</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>81</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>82</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan</token><token_tree>|||adiha_greaterthan</token_tree></record><record><index>83</index><type>operand</type><subtype>number</subtype><token>33</token><token_tree>|||33</token_tree></record><record><index>84</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>85</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>86</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>87</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>88</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan=</token><token_tree>|||adiha_lessthan=</token_tree></record><record><index>89</index><type>operand</type><subtype>number</subtype><token>33.99</token><token_tree>|||33.99</token_tree></record><record><index>90</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>91</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>92</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>93</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>94</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>95</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>96</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>97</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>98</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>99</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>100</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>101</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>102</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>103</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>104</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>105</index><type>operand</type><subtype>number</subtype><token>31</token><token_tree>|||31</token_tree></record><record><index>106</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>107</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>108</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>109</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>110</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>111</index><type>operand</type><subtype>number</subtype><token>32</token><token_tree>|||32</token_tree></record><record><index>112</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>113</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>114</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>115</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>116</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>117</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>118</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>119</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||0</token_tree></record><record><index>120</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|||-</token_tree></record><record><index>121</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|||1</token_tree></record><record><index>122</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>123</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>124</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>125</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>126</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>127</index><type>function</type><subtype>start</subtype><token>IF</token><token_tree>|IF</token_tree></record><record><index>128</index><type>function</type><subtype>start</subtype><token>AND</token><token_tree>||AND</token_tree></record><record><index>129</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>130</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>131</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>132</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_greaterthan=</token><token_tree>|||adiha_greaterthan=</token_tree></record><record><index>133</index><type>operand</type><subtype>number</subtype><token>30</token><token_tree>|||30</token_tree></record><record><index>134</index><type>argument</type><subtype></subtype><token>,</token><token_tree>|||,</token_tree></record><record><index>135</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>|||FieldValue</token_tree></record><record><index>136</index><type>operand</type><subtype>number</subtype><token>300906</token><token_tree>||||300906</token_tree></record><record><index>137</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|||</token_tree></record><record><index>138</index><type>operator-infix</type><subtype>logical</subtype><token>adiha_lessthan</token><token_tree>|||adiha_lessthan</token_tree></record><record><index>139</index><type>operand</type><subtype>number</subtype><token>31</token><token_tree>|||31</token_tree></record><record><index>140</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>141</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>142</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>143</index><type>operand</type><subtype>number</subtype><token>300941</token><token_tree>|||300941</token_tree></record><record><index>144</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>145</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>||*</token_tree></record><record><index>146</index><type>subexpression</type><subtype>start</subtype><token></token><token_tree>||</token_tree></record><record><index>147</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>|||0</token_tree></record><record><index>148</index><type>operator-infix</type><subtype>math</subtype><token>-</token><token_tree>|||-</token_tree></record><record><index>149</index><type>operand</type><subtype>number</subtype><token>2</token><token_tree>|||2</token_tree></record><record><index>150</index><type>subexpression</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>151</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>152</index><type>operand</type><subtype>number</subtype><token>0</token><token_tree>||0</token_tree></record><record><index>153</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>154</index><type>operator-infix</type><subtype>math</subtype><token>adiha_add</token><token_tree>|adiha_add</token_tree></record><record><index>155</index><type>function</type><subtype>start</subtype><token>AverageCurveValue</token><token_tree>|AverageCurveValue</token_tree></record><record><index>156</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>157</index><type>operand</type><subtype>number</subtype><token>-5621</token><token_tree>|||-5621</token_tree></record><record><index>158</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>159</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>160</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>161</index><type>function</type><subtype>start</subtype><token>IsNull</token><token_tree>|IsNull</token_tree></record><record><index>162</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>163</index><type>operand</type><subtype>number</subtype><token>-5615</token><token_tree>|||-5615</token_tree></record><record><index>164</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>165</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>166</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>167</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>168</index><type>operator-infix</type><subtype>math</subtype><token>/</token><token_tree>|/</token_tree></record><record><index>169</index><type>function</type><subtype>start</subtype><token>IsNull</token><token_tree>|IsNull</token_tree></record><record><index>170</index><type>function</type><subtype>start</subtype><token>FieldValue</token><token_tree>||FieldValue</token_tree></record><record><index>171</index><type>operand</type><subtype>number</subtype><token>-5619</token><token_tree>|||-5619</token_tree></record><record><index>172</index><type>function</type><subtype>stop</subtype><token></token><token_tree>||</token_tree></record><record><index>173</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>174</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>175</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record></PSRecordset></Root>'
 

 --Row(1,NULL,NULL)*ContractualVolm()*DealNetPrice(170)*-1
--set @xmlValue='<Root><PSRecordset><record><index>1</index><type>function</type><subtype>start</subtype><token>Row</token><token_tree>|Row</token_tree></record><record><index>2</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>||1</token_tree></record><record><index>3</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>4</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>5</index><type>argument</type><subtype></subtype><token>,</token><token_tree>||,</token_tree></record><record><index>6</index><type>operand</type><subtype>range</subtype><token>NULL</token><token_tree>||NULL</token_tree></record><record><index>7</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>8</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>9</index><type>function</type><subtype>start</subtype><token>ContractualVolm</token><token_tree>|ContractualVolm</token_tree></record><record><index>10</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>11</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>12</index><type>function</type><subtype>start</subtype><token>DealNetPrice</token><token_tree>|DealNetPrice</token_tree></record><record><index>13</index><type>operand</type><subtype>number</subtype><token>170</token><token_tree>||170</token_tree></record><record><index>14</index><type>function</type><subtype>stop</subtype><token></token><token_tree>|</token_tree></record><record><index>15</index><type>operator-infix</type><subtype>math</subtype><token>*</token><token_tree>|*</token_tree></record><record><index>16</index><type>operator-prefix</type><subtype></subtype><token>-</token><token_tree>|-</token_tree></record><record><index>17</index><type>operand</type><subtype>number</subtype><token>1</token><token_tree>|1</token_tree></record></PSRecordset></Root>'


--*/

IF @flag = 'd'
BEGIN
	DELETE fb
	FROM dbo.formula_breakdown fb
	WHERE formula_id = ISNULL(@formula_group_id, @formula_id)
		AND ISNULL(nested_id, 9999999) = ISNULL(@nested_id, 9999999)

	RETURN
END
/*
select * into #formula_parse from formula_parse
select * from #formula_breakdown
select *  from #formula_parse from formula_parse

--*/

--/*
DECLARE @idoc INT
		DECLARE @already_arg_no INT,@previous_op_index_no int,@prev_operator int

EXEC sp_xml_preparedocument @idoc OUTPUT, @xmlValue

SELECT [index] index_no ,
		[type]  func_type		,
		[subtype],
		REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(token,'adiha_add','+'),'adiha_lessthan','<'),'adiha_greaterthan','>'),'adiha_minus','-'), 'adiha_space', ' ') token,
		REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(token_tree,'adiha_add','+'),'adiha_lessthan','<'),'adiha_greaterthan','>'),'adiha_minus','-'), 'adiha_space', ' ') token_tree
		,len(rtrim(replace(REPLACE(REPLACE(token_tree,token,''),CHAR(160), ''),char(32),''))) func_level
		,[index] index_no_new
INTO #formula_parse
FROM   OPENXML (@idoc, '/Root/PSRecordset/record',2)
     WITH ( 
		[index]  int  ,
		[type]  VARCHAR(50)		,
		[subtype]  VARCHAR(50)	,
		token  VARCHAR(100)	,
		token_tree   VARCHAR(100) 
	)

EXEC sp_xml_removedocument @idoc

--select * from #formula_parse order by index_no_new
--return
update #formula_parse set token_tree=token_tree+'parenthesis',token='parenthesis'
			where func_type='subexpression' and subtype='start'

update #formula_parse set func_type='function'  where  func_type='subexpression'


-- handle negative operand expression starts
CREATE TABLE #index_temp (index_no INT, id INT IDENTITY(1,1))


update a set 
		token = '-' + b.token,
       [index_no] = b.[index_no] - 1,
       token_tree = rtrim(a.token_tree)+ ltrim(b.token) ,
	   func_type=b.func_type,
	   subtype=b.subtype
	   OUTPUT INSERTED.index_no INTO #index_temp(index_no)
from 
#formula_parse a inner join #formula_parse b on a.index_no+1=b.index_no and a.func_type = 'operator-prefix' AND a.token = '-'

DELETE #formula_parse from #index_temp a inner join #formula_parse b on b.index_no-1=a.index_no 

--update a set 
--	   func_type='operand'
--	  -- ,subtype='number'
--from #formula_parse a WHERE a.func_type = 'operator-infix' AND a.token in ( '<>','<=','>=')

--select * from #formula_parse
--return
SELECT a.index_no [from_index],
       ISNULL(b.index_no, 100000) [to_index],
       a.id [deduct_factor] INTO #temp_range_index
FROM   #index_temp a LEFT JOIN #index_temp b ON  a.id = b.id + 1

UPDATE a
SET    index_no = a.index_no - b.deduct_factor
FROM   #formula_parse a
       INNER JOIN #temp_range_index b
            ON  a.index_no BETWEEN b.from_index+1 AND b.to_index
            
--handle negative operand expression ends     
--select * from #formula_parse

       
DECLARE @from_index_no int, @to_index_no int,@func_type VARCHAR(50),@func_token VARCHAR(100),@func_level int
DECLARE @prev_from_index_no int, @prev_to_index_no int ,@parent_index_no int,@from_range int,@to_range int
DECLARE @op_index_no int,@operator int,@st VARCHAR(MAX),@operand_no int,@arg_no int,@st_arg_fields varchar(max)
DECLARE @i int,@no_operator int,@arg_func_type VARCHAR(50),@arg_sno int,@st_last_arg_fields varchar(max)

CREATE TABLE #operand(index_no int,subtype VARCHAR(30) COLLATE DATABASE_DEFAULT,operand varchar(30) COLLATE DATABASE_DEFAULT,parent_id int,arg_indx_no int,start_index_no int, func_level int)

CREATE TABLE #formula_breakdown(
	[formula_level] [int] NULL,
	[func_name] [varchar](100) COLLATE DATABASE_DEFAULT NULL,
	[arg_no_for_next_func] [int] NULL,
	[parent_nested_id] [int] NULL,
	[level_func_sno] [int] NULL,
	[parent_level_func_sno] [int] NULL,
	[arg1] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg2] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg3] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg4] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg5] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg6] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg7] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg8] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg9] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg10] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg11] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg12] [varchar](50) COLLATE DATABASE_DEFAULT NULL,upd_statement_from varchar(30) COLLATE DATABASE_DEFAULT,sno int identity(1,1),update_ts datetime2
) 


CREATE TABLE #formula_breakdown_eff(
	[formula_level] [int] NULL,
	[func_name] [varchar](100) COLLATE DATABASE_DEFAULT NULL,
	[arg_no_for_next_func] [int] NULL,
	[parent_nested_id] [int] NULL,
	[level_func_sno] [int] NULL,
	[parent_level_func_sno] [int] NULL,
	[arg1] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg2] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg3] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg4] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg5] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg6] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg7] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg8] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg9] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg10] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg11] [varchar](50) COLLATE DATABASE_DEFAULT NULL,
	[arg12] [varchar](50) COLLATE DATABASE_DEFAULT NULL,upd_statement_from varchar(30) COLLATE DATABASE_DEFAULT,sno int,update_ts datetime2
) 

SELECT 	s.index_no start_no,e.index_no end_no ,	s.func_type,s.token ,s.func_level
INTO #tmp_func
FROM  #formula_parse s
CROSS APPLY 
( 
	SELECT top(1) index_no,token FROM #formula_parse 
	WHERE index_no>s.index_no AND func_type=s.func_type 
		AND func_level=s.func_level 
		AND subtype='stop'  AND s.subtype='start' 
   ORDER BY index_no
) e
UNION ALL
SELECT --MIN(index_no) 
	0 start_no,MAX(index_no)+1 end_no,'subexpression' func_type,'' token ,0 func_level FROM #formula_parse 


create table #temp_arguments (rowid int,frm_arg int, to_arg int,func_type varchar(100) COLLATE DATABASE_DEFAULT)
create table #argument(rowid INT IDENTITY(1,1),arg_index_no INT,operand1_index_no INT, operand2_index_no INT)


	--select * from #tmp_func


DECLARE tmp_func CURSOR FOR -- loop through each function or  paranthesis whose subtype have 'start' and 'stop'
	SELECT start_no,end_no ,func_type,token,func_level FROM #tmp_func 
--	WHERE start_no=2 
	ORDER BY func_level desc,start_no asc
OPEN tmp_func
FETCH NEXT FROM tmp_func INTO @from_index_no, @to_index_no,@func_type,@func_token,@func_level
WHILE @@FETCH_STATUS = 0
BEGIN
	if @prev_from_index_no+1=@from_index_no and @prev_to_index_no+1=@to_index_no  AND @prev_from_index_no IS NOT NULL and @func_type='subexpression' --ignore unnecessary parenthesis
		goto next_loop_func

	IF @func_type='function'
	BEGIN

		truncate TABLE #temp_arguments
		truncate TABLE #argument
		

		if not exists (select 1 FROM  #formula_parse where func_type ='argument' and index_no between @from_index_no and @to_index_no and func_level=@func_level+1 ) -- if there are only on argument in function
		begin
			insert into #argument(arg_index_no,operand1_index_no, operand2_index_no) 
				select @from_index_no arg_index_no,@from_index_no operand1_index_no,@to_index_no operand2_index_no
		
			insert into #temp_arguments(rowid , frm_arg,to_arg,func_type)
			SELECT arg.rowid ,arg.arg_index_no frm_arg,arg.operand2_index_no to_arg,op2.func_type
			FROM  #argument arg 
				LEFT JOIN  #formula_parse op2 ON arg.arg_index_no+1=op2.index_no  
			where 	 arg.operand2_index_no-arg.arg_index_no<>2		
		end
		else    -- if there are multiple arguments in function
		begin
			insert into #argument(arg_index_no,operand1_index_no, operand2_index_no) 
			SELECT  a.index_no arg_index_no,op1.index_no operand1_index_no,op2.index_no operand2_index_no
			--select * 
			from ( select * FROM  #formula_parse  where func_type ='argument' and func_level=@func_level+1
			and  index_no between @from_index_no AND  @to_index_no ) a
			 cross apply (
 				SELECT top(1) index_no from #formula_parse 
 				where index_no<a.index_no 
 				AND ( 
 						(func_type ='argument' and func_level=@func_level+1 ) 
 						or (subtype='start'and func_level=@func_level) 
 					)
				 ORDER BY index_no desc
			 ) op1
			 cross apply (
 				SELECT top(1) index_no from #formula_parse 
				where index_no>a.index_no 
				AND ( 
 						(func_type ='argument' and func_level=@func_level+1 ) 
 						or (subtype='stop'and func_level=@func_level) 
 					)
				
				ORDER BY index_no
			 ) op2
			order BY arg_index_no

			insert into #temp_arguments(rowid , frm_arg,to_arg,func_type)
			SELECT arg.rowid,arg.operand1_index_no frm_arg, arg.arg_index_no to_arg,op1.func_type
			FROM  #argument arg 
				LEFT JOIN  #formula_parse op1 ON arg.operand1_index_no+1=op1.index_no  
			where 	arg.rowid=1 AND arg.arg_index_no-arg.operand1_index_no<>2
			union all
			SELECT arg.rowid+1 rowid,arg.arg_index_no frm_arg,arg.operand2_index_no to_arg,op2.func_type
			FROM  #argument arg 
				LEFT JOIN  #formula_parse op2 ON arg.arg_index_no+1=op2.index_no  
			where 	 arg.operand2_index_no-arg.arg_index_no<>2	
		end
		
	--only loop through argument  of expression or function
		DECLARE tmp_arguments CURSOR FOR --loop through each argument within a function or a paranthesis
			SELECT rowid,frm_arg, to_arg,func_type FROM  #temp_arguments  
		OPEN tmp_arguments
		FETCH NEXT FROM tmp_arguments INTO @arg_sno, @from_range,@to_range ,@arg_func_type
		WHILE @@FETCH_STATUS = 0
		BEGIN
		--SELECT * FROM #operand
		--SELECT * FROM #temp_arguments
			if	@arg_func_type IN ('operand','function','subexpression')	--		@arg_func_type='operand' --will call only expression in argument and not call for function in argument
			begin
				GOTO parse_expression
				
function_level:

				truncate table #formula_breakdown_eff

				UPDATE #formula_breakdown set [arg_no_for_next_func]= @arg_sno ,[parent_level_func_sno]=@from_index_no,upd_statement_from='upd006',update_ts=CURRENT_TIMESTAMP
					output inserted.* into #formula_breakdown_eff
					FROM #formula_breakdown f  
					INNER JOIN
					(
					SELECT max(parent_id) parent_id from #operand   
						where parent_id IS NOT NULL AND arg_indx_no=@from_range AND index_no between @from_range and @to_range
					) o on	f.level_func_sno=o.parent_id and [parent_level_func_sno] is null
				 

				 
				IF @arg_func_type='function'
				BEGIN
					
					truncate table #formula_breakdown_eff

					UPDATE #formula_breakdown set [arg_no_for_next_func]= @arg_sno ,[parent_level_func_sno]=@from_index_no,upd_statement_from='upd007',update_ts=CURRENT_TIMESTAMP
							output inserted.* into #formula_breakdown_eff
							FROM #formula_breakdown f  
							INNER JOIN
							(
	 						SELECT max(level_func_sno) parent_id from #formula_breakdown   
								where [parent_level_func_sno] IS NULL  AND level_func_sno between @from_range and @to_range
							) o on	f.level_func_sno=o.parent_id 
							--return
				END				 
				 
			END
	
			FETCH NEXT FROM tmp_arguments INTO @arg_sno, @from_range,@to_range ,@arg_func_type
		END
		CLOSE tmp_arguments
		DEALLOCATE tmp_arguments
	
			
			
		-----------------------------------------------------------------
		--start:insert function -----
		----------------------------------------------------------------------
		-------------------------------------------------------------------------
		---start of handliing argument in function 
		--------------------------------------------------------------------------
	
		 select @st=NULL,@st_arg_fields=NULL,@st_last_arg_fields=null
		 
		 SELECT @st=ISNULL(@st+',''','''')+ isnull(tok.token,'NULL')+''''
		 FROM  
		  (
			SELECT arg.rowid,CASE WHEN arg.arg_index_no-arg.operand1_index_no=2 THEN isnull(CONVERT(VARCHAR,op1.token,2),'NULL')
							when arg.arg_index_no=arg.operand1_index_no THEN isnull(CONVERT(VARCHAR,op1.token,2),'NULL') --while only one argument in function
						ELSE 'NULL' END token
			FROM  #argument arg 
				LEFT JOIN  #formula_parse op1 ON arg.operand1_index_no+1=op1.index_no  and op1.func_type='operand'
			where 	arg.rowid=1
			union all
			(SELECT  arg.rowid+1 rowid ,	CASE WHEN arg.operand2_index_no-arg.arg_index_no=2 THEN isnull(CONVERT(VARCHAR,op2.token,2),'NULL') ELSE 'NULL' END token
			FROM  #argument arg 
				LEFT JOIN  #formula_parse op2 ON arg.operand2_index_no-1=op2.index_no and op2.func_type='operand' 
			where arg.arg_index_no<>arg.operand1_index_no )--exclude while only one argument in function
		  ) tok	order by tok.rowid 
		  
			--select @st	
			--select * from #argument
		SELECT @st_arg_fields=ISNULL(@st_arg_fields+',','')+ 'arg'+CAST(rowid as varchar)  FROM #argument order by rowid 
			
		if isnull(@st_arg_fields,'')<>''
		begin
			select  @st_last_arg_fields=ISNULL(@st_last_arg_fields+',','') +',arg'+cast(MAX(rowid)+1 as varchar) from #argument where arg_index_no<>operand1_index_no --exclude this statement while only one argument in function
			
			if ISNULL(@st_last_arg_fields,'')=''
				set @st_arg_fields=','+@st_arg_fields
			else
				set @st_arg_fields=','+@st_arg_fields+ @st_last_arg_fields
			
			set @st=','+@st
		end
		else
			select @st_arg_fields='',@st=''


		if @func_token='parenthesis'
		begin
				select @st_arg_fields='',@st=''
		end

		--select @st_arg_fields	
		set @st='INSERT into #formula_breakdown([level_func_sno],[formula_level] ,[func_name],[parent_nested_id]'+@st_arg_fields+') 
			SELECT ' + cast(@from_index_no AS VARCHAR) +' level_func_sno
			,' +cast(@func_level*100 AS VARCHAR) +' func_level
			,'''+ @func_token + ''' func_name,null'+@st
			
		exec spa_print @st
		exec(@st)	

		if @func_token='parenthesis'
			UPDATE top(1) #formula_breakdown set [arg_no_for_next_func]= 1 ,[parent_level_func_sno]=@from_index_no,upd_statement_from='updzzz:'+cast(@from_index_no as varchar),update_ts=CURRENT_TIMESTAMP
				output inserted.* into #formula_breakdown_eff
				   where [parent_level_func_sno] is null
						and level_func_sno between @from_index_no+1 and @to_index_no
			--order by sno desc 
		
			-----------------------------------------------------------------
			--end:insert function -----
			----------------------------------------------------------------------

	END --if funct
	ELSE IF @func_type='subexpression'--subexpression
	BEGIN
		select @from_range=@from_index_no,  @to_range=@to_index_no
		
		-------------------------------------------------------------------------
		---start of handliing operator in  parenthesis
		--------------------------------------------------------------------------
		GOTO parse_expression
subexpression_level:

	END	

	IF OBJECT_ID('tempdb..#argument') IS NOT NULL
		truncate TABLE #argument
	IF OBJECT_ID('tempdb..#temp_arguments') IS NOT NULL
		truncate TABLE #temp_arguments
next_loop_func:	
 
 
	
	IF @func_type='function' --if the function's first argument is function
	BEGIN
		if exists(select 1 from #formula_parse where index_no=@from_index_no+1 and subtype='start') --if function first argument is expression with child function
		begin
			
			if exists(select 1 from #formula_parse where index_no=@to_index_no-1 and subtype='stop' )
			begin
				--select @from_index_no,@to_index_no
				--select * from #formula_breakdown
				--return

				truncate table #formula_breakdown_eff

				UPDATE #formula_breakdown set [arg_no_for_next_func]= 1 ,[parent_level_func_sno]=@from_index_no,upd_statement_from='upd008:'+cast(@from_index_no as varchar),update_ts=CURRENT_TIMESTAMP
				output inserted.* into #formula_breakdown_eff
				 FROM #formula_breakdown f  
					 INNER JOIN
					 (
						SELECT max(level_func_sno) parent_id from #formula_breakdown   
							where [parent_level_func_sno] IS NULL  AND level_func_sno>1
					 ) o on	f.level_func_sno=o.parent_id and f.level_func_sno between @from_index_no+1 and @to_index_no
			end
			truncate table #formula_breakdown_eff

			UPDATE #formula_breakdown set [arg_no_for_next_func]= 1 ,[parent_level_func_sno]=@from_index_no,upd_statement_from='upd009:'+cast(@from_index_no as varchar),update_ts=CURRENT_TIMESTAMP
			output inserted.* into #formula_breakdown_eff
			 FROM #formula_breakdown f  
			 INNER JOIN
			 (
				SELECT max(level_func_sno) parent_id from #formula_breakdown   
					where [parent_level_func_sno] IS NULL  AND level_func_sno>@from_index_no
			 ) o on	f.level_func_sno=o.parent_id AND  (o.parent_id -@from_index_no)=1
			 where f.level_func_sno between @from_index_no and @to_index_no
		end 
	END			
				 					 
	select @prev_from_index_no=@from_index_no , @prev_to_index_no=@to_index_no --ignore unnecessary parenthesis
	FETCH NEXT FROM tmp_func INTO @from_index_no, @to_index_no,@func_type,@func_token,@func_level
END
CLOSE tmp_func
DEALLOCATE tmp_func

--finalizing output
update #formula_breakdown set formula_level=0 ,upd_statement_from='upd010' where arg_no_for_next_func is null and parent_level_func_sno is null and formula_level=1

SELECT rowid=IDENTITY(INT,1,1), formula_level INTO #tmp_func_level from #formula_breakdown GROUP BY formula_level ORDER BY formula_level

update #formula_breakdown set [parent_nested_id]=arg1 WHERE func_name IN('ROW','CountRow','RowSum') AND arg1 IS NOT null 

--/*
DELETE dbo.formula_breakdown WHERE formula_id =ISNULL(@formula_group_id,@formula_id) AND isnull(nested_id,9999999)=isnull(@nested_id,9999999)

INSERT INTO dbo.formula_breakdown(
	formula_id,nested_id,formula_level,func_name,arg_no_for_next_func,parent_nested_id,level_func_sno,parent_level_func_sno,
	arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10,arg11,arg12,create_ts,formula_nested_id,data_source_id
)
--*/
SELECT ISNULL(@formula_group_id ,@formula_id) formula_id,@nested_id nested_id,t.rowid formula_level,f.[func_name],f.[arg_no_for_next_func],
	f.[parent_nested_id] ,f.[level_func_sno],f.[parent_level_func_sno]
	,nullif(f.[arg1],'null') arg1,nullif(f.[arg2],'null') arg2,nullif(f.[arg3],'null') arg3,nullif(f.[arg4],'null') arg4
	,nullif(f.[arg5] ,'null') arg5,nullif(f.[arg6],'null') arg6,nullif(f.[arg7],'null') arg7,nullif(f.[arg8],'null') arg8
	,nullif(f.[arg9],'null') arg9,nullif(f.[arg10],'null') arg10,nullif(f.[arg11],'null') arg11,nullif(f.[arg12],'null') arg12,GETDATE() create_ts,@formula_nested_id, ds.data_source_id
from #tmp_func_level t 
INNER JOIN #formula_breakdown f on t.formula_level=f.formula_level
LEFT JOIN [data_source] ds
ON ds.[name] = f.[func_name]
  AND ds.[category] = 106501

RETURN 


--*****************************End of SP****************************************************************************88
----------------------------------------------------------------------------------------------------------


---------------Parse expression : it is use as SP/function-------------------------------------------------------------------------------------------
parse_expression:

------------------------------------------------------------------------
---start of handliing operator in function or parenthesis
--------------------------------------------------------------------------



		if OBJECT_ID('tempdb..#operator') is not null
			drop table  #operator 
		
		SELECT index_no,
			case token
				WHEN '^' then 1 --power eg 2^3=2*2*2
				WHEN '%' then 2 -- remainder 7%5=2
				WHEN '/' then 3 
				WHEN '*' then 4 
				WHEN '-' then 5 
				WHEN '+' then 6 
				WHEN '<' then 7 
				WHEN '<=' then 8 
				WHEN '=' then 9
				WHEN '>' then 10 
				WHEN '>=' then 11 
				WHEN '<>' then 12
			END operator,token
		 into #operator 
		 from #formula_parse where index_no >  @from_range
			 AND index_no<  @TO_range 
			 and func_type IN ('operator-infix','operator-postfix')
			AND len(rtrim(replace(REPLACE(REPLACE(token_tree,token,''),CHAR(160), ''),char(32),'')))=@func_level+1 --@func_level=3
			
		SELECT @no_operator=@@ROWCOUNT
		
		--select * from #operator
		
	--delete #operand

		INSERT INTO #operand(index_no,subtype,operand,parent_id ,arg_indx_no,start_index_no,func_level)
		SELECT f.index_no,f.subtype,f.token operand,null parent_id,isnull(@from_range,9999999), case when f.subtype='start' then f.index_no else null end start_index_no
		,@func_level+1 func_level
		FROM #formula_parse f WHERE  f.index_no BETWEEN @from_range AND @to_range 
		AND len(rtrim(replace(REPLACE(REPLACE(token_tree,token,''),CHAR(160), ''),char(32),'')))=@func_level+1 
		AND f.func_type IN ('operand','function','subexpression') 
		
		--update by start or function sno for the stop record oh the same function.
		update #operand set start_index_no= start_indx.index_no
		from #operand stop_indx
		cross apply
		(
			select  top(1) index_no from #operand where subtype='start' and index_no<stop_indx.index_no and func_level=stop_indx.func_level
			order by index_no desc
		) start_indx
		where --stop_indx.start_index_no is null and 
		stop_indx.subtype='stop'
	
		
		DECLARE tmp_operator_only CURSOR FOR --loop through distinct operator of a function or a paranthesis for belonging operand  to operator
		SELECT distinct operator FROM #operator 
		ORDER BY operator
		OPEN tmp_operator_only
		FETCH NEXT FROM tmp_operator_only INTO  @operator
		WHILE @@FETCH_STATUS = 0
		BEGIN
			update #operand set  parent_id =otor.index_no from #operand oand
				inner join #operator otor on otor.index_no between oand.index_no-1 AND oand.index_no+1 and oand.parent_id is null
					and otor.operator=@operator 
			FETCH NEXT FROM tmp_operator_only INTO  @operator
		END
		CLOSE tmp_operator_only
		DEALLOCATE tmp_operator_only	

--select * from #operand
 --return
		SET @i=0
		set @previous_op_index_no=null
		DECLARE tmp_operator CURSOR FOR --loop through each operator within a function or a paranthesis
		SELECT index_no,operator FROM #operator 
		ORDER BY operator,index_no
		OPEN tmp_operator
		FETCH NEXT FROM tmp_operator INTO @op_index_no, @operator
		WHILE @@FETCH_STATUS = 0
		BEGIN

		
			--select * from #formula_parse

			--insert operator from low level	


			
			EXEC spa_print 'yyyyyyyyyyyyyyyyyyyyyyyyyyyy'
			--update parent opertator' parent field for first operands (this is for continineous multiple operators like *, + ,-)
			
			--This is for function argument expression-----------------------------------------------------------------
			truncate table #formula_breakdown_eff

			--select @op_index_no
			--select * from	 #formula_breakdown 
		--select * from  #operand
		

			UPDATE #formula_breakdown set [arg_no_for_next_func]= 1 ,[parent_level_func_sno]=@op_index_no,upd_statement_from='upd001',update_ts=CURRENT_TIMESTAMP
				output inserted.* into #formula_breakdown_eff
			 FROM #formula_breakdown f  INNER JOIN #operand o on f.level_func_sno=o.parent_id 
			 and (index_no=@op_index_no-1) AND parent_id IS NOT NULL AND o.arg_indx_no=isnull(@from_range,9999999) AND [parent_level_func_sno] IS null
			  
			--select * from	 #formula_breakdown 

			 truncate table #formula_breakdown_eff

			UPDATE #formula_breakdown set [arg_no_for_next_func]= 2 ,[parent_level_func_sno]=@op_index_no,upd_statement_from='upd002',update_ts=CURRENT_TIMESTAMP
				output inserted.* into #formula_breakdown_eff
			 FROM #formula_breakdown f  INNER JOIN #operand o on f.level_func_sno=o.parent_id  
			 AND index_no=@op_index_no+1 AND parent_id IS NOT null --AND o.arg_indx_no=isnull(@from_range,9999999)
			  AND [parent_level_func_sno] IS null
			-- and [parent_level_func_sno]<>@op_index_no
			----------------------------------------------------------------------------------------------------------------------------------
			
			EXEC spa_print 'yyyyyyyyyyyyyyyyyyyyyyyyyyyy1'


			INSERT into #formula_breakdown([level_func_sno],[formula_level] ,[func_name],[parent_nested_id],[arg1],[arg2]) 
			SELECT @op_index_no level_func_sno,(@func_level*100)+(@no_operator-@i) func_level
			, case @operator
				WHEN 1 then '^' --power eg 2^3=2*2*2
				WHEN 2 then '%' -- remainder 7%5=2
				WHEN 3 then '/'
				WHEN 4 then '*'
				WHEN 5 then '-'
				WHEN 6 then '+'
				WHEN 7 then '<'
				WHEN 8 then '<='
				WHEN 9 then '='
				WHEN 10 then '>'
				WHEN 11 then '>='
				WHEN 12 then '<>'
			END func_name,null,
				case when op1.subtype='stop' THEN NULL 
				else 
					case when op1.parent_id =@op_index_no then  CONVERT(VARCHAR,op1.operand ,2) else null end
				end  arg1
				,case when op2.subtype='start' THEN NULL
				else 
					case when op2.parent_id=@op_index_no then  CONVERT(VARCHAR,op2.operand ,2) else null end
				end  arg2
			FROM #operand op2 INNER JOIN #operand op1 ON  op1.index_no=@op_index_no-1  AND op2.index_no=@op_index_no+1  
					AND op1.arg_indx_no=isnull(@from_range,9999999)
			

			
			--This is for subexpression-----------------------------------------------------------------------------	
				--update child opertator' parent field for first & second operands (this for next level and 1st operand (subtype='stop'))
					
			truncate table #formula_breakdown_eff


			UPDATE #formula_breakdown set [arg_no_for_next_func]= 1 ,[parent_level_func_sno]=@op_index_no,upd_statement_from='upd003',update_ts=CURRENT_TIMESTAMP
				output inserted.* into #formula_breakdown_eff
				FROM #operand op
					INNER JOIN #formula_breakdown f  ON f.level_func_sno=op.start_index_no
					and	op.parent_id=@op_index_no AND op.subtype='stop' --AND op.arg_indx_no=isnull(@from_range,9999999)
					and [parent_level_func_sno] is null
			--if @@ROWCOUNT>0 -- marked as it is updated in parent function/sub in 1st operand , so that the same operand is not updated for other func/sub as 2nd opernd.
				
			if exists(select * from #formula_breakdown_eff)
			begin 
				UPDATE #operand set  start_index_no =-1*start_index_no
					 FROM #operand op where	parent_id=@op_index_no AND op.subtype='start' --AND op.arg_indx_no=isnull(@from_range,9999999)
						and index_no<@op_index_no
				
				EXEC spa_print 'yyyyyyyyyyyyyyyyyyyyyyyyyyyy2'
					--update child opertator' parent field for first & second operands (this for next level and 2nd operand (subtype='start'))
				
			--	select @op_index_no
				truncate table #formula_breakdown_eff
				--return
				UPDATE #formula_breakdown set [arg_no_for_next_func]= 2 ,[parent_level_func_sno]=@op_index_no,upd_statement_from='upd004',update_ts=CURRENT_TIMESTAMP
				output inserted.* into #formula_breakdown_eff
						 FROM #operand op
						INNER JOIN #formula_breakdown f  ON f.level_func_sno=op.start_index_no
						and	parent_id=@op_index_no AND op.subtype='start' --AND op.arg_indx_no=isnull(@from_range,9999999)
					and [parent_level_func_sno] is null


		--	if @@ROWCOUNT>0 -- marked as it is updated in parent function/sub in 1st operand , so that the same operand is not updated for other func/sub as 2nd opernd.
				if exists(select * from #formula_breakdown_eff)
					UPDATE #operand set  start_index_no =-1*start_index_no
						 FROM #operand op where	parent_id=@op_index_no AND op.subtype='stop' --AND op.arg_indx_no=isnull(@from_range,9999999)
						 and index_no>@op_index_no
			end 
			EXEC spa_print 'zzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzzz'

			SET @i=@i+1


			truncate table #formula_breakdown_eff
			UPDATE f set [arg_no_for_next_func]=case when f1.arg1 is null then 1 else 2 end,[parent_level_func_sno]=@op_index_no,upd_statement_from='updOPR',update_ts=CURRENT_TIMESTAMP
				output inserted.* into #formula_breakdown_eff
				FROM #formula_breakdown f 
				cross join 
				( select a.* from #formula_breakdown  a left join #formula_breakdown b on a.level_func_sno=b.parent_level_func_sno
					where b.level_func_sno is null and a.level_func_sno=@op_index_no and  coalesce(a.arg1,a.arg2 ) is not null
				) f1
			where f.level_func_sno=@prev_operator and f.[parent_level_func_sno] is null
			
			
			--select @op_index_no
			----select * from #operand
			--select * from #formula_breakdown
			--return


			--	SELECT * from #operand	
			--SELECT * from #operator			
			--  SELECT * FROM #formula_breakdown
			--select * from #formula_parse
			set @prev_operator=@op_index_no
			set @previous_op_index_no=@op_index_no

			FETCH NEXT FROM tmp_operator INTO @op_index_no, @operator
		END
		CLOSE tmp_operator
		DEALLOCATE tmp_operator	
		set @already_arg_no=null




		-- Handling case for multiple records that have null in the column [parent_level_func_sno] 
		------------------------------------------------------------------------------------------------------------------------------
		IF EXISTS(SELECT 1 from #formula_breakdown WHERE  [parent_level_func_sno] is null  GROUP BY [parent_level_func_sno] HAVING COUNT(1)>1)
		BEGIN 
				--	select @op_index_no, @from_range , @to_range
	
			if object_id('tempdb..#temp_erase_parent') is not null
				drop table #temp_erase_parent

			--if 	@op_index_no=148 return
			 select b.*,case when a.arg1 is not null or a.arg2 is not null then 1 else 2 end no_arg  into   #temp_erase_parent 
			 from #formula_breakdown a
			 inner join #formula_breakdown b on a.level_func_sno=b.parent_level_func_sno
			  and a.formula_level=1 and a.parent_level_func_sno is null
			  and b.upd_statement_from in ('upd003','upd004')
			  and a.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
			  and not (a.arg1 is not null and a.arg2 is not null)
			 
			--   select * from #formula_breakdown

			if exists(select 1 from #temp_erase_parent group by parent_level_func_sno having count(1)=max(no_arg))
			begin
			

				update a set parent_level_func_sno=null,upd_statement_from=null,update_ts=null,arg_no_for_next_func=null  from #formula_breakdown a
				 inner join #temp_erase_parent b on a.level_func_sno=b.level_func_sno
				  and b.arg_no_for_next_func=1 

			end


			truncate table #formula_breakdown_eff
			--return
			-- operand is direct/fist level 
			UPDATE #formula_breakdown set [arg_no_for_next_func]= case when parent_func.parent_func_id>fb.[level_func_sno] then 1 ELSE 2 end  --case when parent_arg.parent_func_arg=2 then 1 ELSE 2 end 
				,[parent_level_func_sno]=parent_func.parent_func_id,upd_statement_from='last999',update_ts=CURRENT_TIMESTAMP
			from #formula_breakdown fb
			cross apply
				(
					SELECT max(isnull(a.parent_id,b.parent_id)) parent_func_id 
				 from #operand a
						inner join #operand b on a.index_no=b.start_index_no 
						where a.index_no=fb.[level_func_sno]
					) parent_func
			WHERE fb.[parent_level_func_sno] IS  NULL AND fb.formula_level>0 and parent_func.parent_func_id is not null

			
			
	
--handle  operand is derived from previous operator result (opertor that have only one operand (function id in parent_function has only one record.)
			--select * from #formula_breakdown
			--return
			while 1=1  ---fb.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
			begin

				if not exists(
				select * from  
				(
					SELECT child.[parent_level_func_sno] parent_id 
					,from_index_no =max(case when child.arg_no_for_next_func=1 then child.[parent_level_func_sno]+1 else 0 end),
									to_index_no =max(case when child.arg_no_for_next_func=1 then   999999999 else child.[parent_level_func_sno]-1   end)
					from #formula_breakdown child  inner join #formula_breakdown parent on child.parent_level_func_sno=parent.level_func_sno
					where child.[parent_level_func_sno] is not null and parent.arg1 is null and parent.arg2 is null
					and	parent.func_name  IN ( '^','%','/','*','-')	
						and child.[parent_level_func_sno]<>@op_index_no
					group by child.[parent_level_func_sno] having count(1)=1
								
				) parent_func
				cross apply
				(
					select top(1)	
						[level_func_sno] child_func_id
								
					from #formula_breakdown 
						where level_func_sno between parent_func.from_index_no and parent_func.to_index_no
						and [parent_level_func_sno] is  null
						order by [level_func_sno]
				) child_func

				inner join #formula_breakdown a on a.level_func_sno=child_func.child_func_id
				and	a.func_name  IN ( '^','%','/','*','-')
				and a.[level_func_sno]<>@op_index_no 
				)    break

				--if @op_index_no=154 return
				truncate table #formula_breakdown_eff

				UPDATE top(1) #formula_breakdown set [arg_no_for_next_func]= case when parent_func.parent_id>a.[level_func_sno] then 1 ELSE 2 end 
					,[parent_level_func_sno]=parent_func.parent_id,upd_statement_from='last999a',update_ts=CURRENT_TIMESTAMP

		--	select * from #formula_breakdown
		--select --child_func.child_func_id,
		--parent_func.*
				from  
				(
					SELECT child.[parent_level_func_sno] parent_id 
					,from_index_no =max(case when child.arg_no_for_next_func=1 then child.[parent_level_func_sno]+1 else 0 end),
									to_index_no =max(case when child.arg_no_for_next_func=1 then   999999999 else child.[parent_level_func_sno]-1   end)
					from #formula_breakdown child  inner join #formula_breakdown parent on child.parent_level_func_sno=parent.level_func_sno
					where child.[parent_level_func_sno] is not null and parent.arg1 is null and parent.arg2 is null
					and	parent.func_name  IN ( '^','%','/','*','-')	
						and child.[parent_level_func_sno]<>@op_index_no
					group by child.[parent_level_func_sno] having count(1)=1
								
				) parent_func
				cross apply
				(
					select top(1)	
						[level_func_sno] child_func_id
								
					from #formula_breakdown 
						where level_func_sno between parent_func.from_index_no and parent_func.to_index_no
						and [parent_level_func_sno] is  null
						order by [level_func_sno]
				) child_func

				inner join #formula_breakdown a on a.level_func_sno=child_func.child_func_id
				and	a.func_name  IN ( '^','%','/','*','-')
				and a.[level_func_sno]<>@op_index_no 


			end
		
			
			
			--return

			--handle  operand is derived from previous operator result (opertor do not have any operand so all other operator 's [parent_level_func_sno] is null)
		--	----------------------------------------------------------------------------------------------------------------------------------------------------
		--	select * from #formula_breakdown
		--	--select @op_index_no
		--return

			--declare @func_loop int
			--set @func_loop=0

		--while @func_loop<1
		--begin



			while 1=1  ---fb.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
			begin

		--	select * from #formula_breakdown

				if object_id('tempdb..#temp_child_to_update') is not null
				drop table #temp_child_to_update

				select parent_func.parent_id,child_func.child_func_id child1,child_func2.child_func_id child2,parent_arg.parent_func_arg 
					, parent_func.formula_level parent_level,child_func3.child_func_id child3,child_func3.formula_level child3_level
				into #temp_child_to_update
				from	(
						SELECT a.[level_func_sno] parent_id,a.formula_level from #formula_breakdown a 
						left join (
							SELECT [parent_level_func_sno] parent_id from #formula_breakdown 
								where [parent_level_func_sno] is not null group by [parent_level_func_sno] having count(1)>0
						) used_parent on used_parent.parent_id=a.[level_func_sno]
						where used_parent.parent_id is null and  a.[parent_level_func_sno] is null  and a.arg1 is null and a.arg2 is null
					) parent_func
					outer apply
					(
						SELECT max(a.arg_no_for_next_func) parent_func_arg  from #formula_breakdown a
							where parent_level_func_sno=parent_func.parent_id
						) parent_arg	

					outer apply
					(
						select top(1)	[level_func_sno] child_func_id,formula_level from #formula_breakdown 
							where level_func_sno <parent_func.parent_id and [parent_level_func_sno] is  null and [level_func_sno]<>@op_index_no 
								and formula_level>parent_func.formula_level
							order by formula_level desc, [level_func_sno] 
					) child_func
					outer apply
					(
						select top(1)	[level_func_sno] child_func_id,formula_level from #formula_breakdown 
							where level_func_sno >parent_func.parent_id and
							 [parent_level_func_sno] is  null and [level_func_sno]<>@op_index_no and formula_level>parent_func.formula_level
							order by formula_level, [level_func_sno]

					) child_func2
					outer apply
					(
						select top(1)	[level_func_sno] child_func_id,formula_level from #formula_breakdown 
							where level_func_sno >parent_func.parent_id and
							 [parent_level_func_sno] is  null and [level_func_sno]<>@op_index_no and formula_level<parent_func.formula_level
							order by formula_level desc, [level_func_sno]

					) child_func3

					left join #formula_breakdown a 	on a.level_func_sno= isnull(child_func.child_func_id ,child_func2.child_func_id)
				where coalesce(child_func.child_func_id ,child_func2.child_func_id,child_func3.child_func_id) is not null
					and a.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
				
				
				truncate table #formula_breakdown_eff

				UPDATE top(1) #formula_breakdown set [arg_no_for_next_func]= --case when upd.parent_id>a.[level_func_sno] then 1 ELSE 2 end 
						case when isnull(upd.parent_func_arg,2)=2 then 1 else 2  end ---expected always 2
							,[parent_level_func_sno]=upd.parent_id,upd_statement_from='last777a',update_ts=CURRENT_TIMESTAMP
				from  #formula_breakdown a inner join #temp_child_to_update upd	on a.level_func_sno=upd.child1 and
								a.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
								and a.[level_func_sno]<>@op_index_no
	
				truncate table #formula_breakdown_eff
				
				
				
				--if @op_index_no=154 return
		  
				UPDATE top(1) #formula_breakdown set [arg_no_for_next_func]= --case when upd.parent_id>a.[level_func_sno] then 1 ELSE 2 end 
								case when isnull(upd.parent_func_arg,1)=2 then 1 else 2  end ---expected always 2
									,[parent_level_func_sno]=upd.parent_id,upd_statement_from='last777b',update_ts=CURRENT_TIMESTAMP
					,formula_level=case when a.formula_level<  upd.parent_level then upd.parent_level else  a.formula_level end
				from  #formula_breakdown a inner join #temp_child_to_update upd	on a.level_func_sno=isnull(upd.child2,upd.child3) and
										a.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
										and a.[level_func_sno]<>@op_index_no


				if exists(select * from  #temp_child_to_update where child2 is null and child3 is not null) --adjusting formula lavel
					UPDATE top(1) #formula_breakdown set  formula_level=upd.child3_level
					from  #formula_breakdown a inner join #temp_child_to_update upd	on a.level_func_sno=upd.parent_id and
											a.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
											and a.[level_func_sno]<>@op_index_no
				
		--select * from #formula_breakdown
						
				if not exists(select * from  #temp_child_to_update)  break

			end
--/*


--handle  operand is derived from previous operator result (opertor that have only one operand (function id in parent_function has only one record.)
			--select * from #formula_breakdown
			--return
			while 1=1  ---fb.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
			begin

				if not exists(
				select * from  
				(
					SELECT child.[parent_level_func_sno] parent_id 
					,from_index_no =max(case when child.arg_no_for_next_func=1 then child.[parent_level_func_sno]+1 else 0 end),
									to_index_no =max(case when child.arg_no_for_next_func=1 then   999999999 else child.[parent_level_func_sno]-1   end)
					from #formula_breakdown child  inner join #formula_breakdown parent on child.parent_level_func_sno=parent.level_func_sno
					where child.[parent_level_func_sno] is not null and parent.arg1 is null and parent.arg2 is null
					and	parent.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')	
						and child.[parent_level_func_sno]<>@op_index_no
					group by child.[parent_level_func_sno] having count(1)=1
								
				) parent_func
				cross apply
				(
					select top(1)	
						[level_func_sno] child_func_id
								
					from #formula_breakdown 
						where level_func_sno between parent_func.from_index_no and parent_func.to_index_no
						and [parent_level_func_sno] is  null
						order by [level_func_sno]
				) child_func

				inner join #formula_breakdown a on a.level_func_sno=child_func.child_func_id
				and	a.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
				and a.[level_func_sno]<>@op_index_no 
				)    break

				--if @op_index_no=154 return
				truncate table #formula_breakdown_eff

				UPDATE top(1) #formula_breakdown set [arg_no_for_next_func]= case when parent_func.parent_id>a.[level_func_sno] then 1 ELSE 2 end 
					,[parent_level_func_sno]=parent_func.parent_id,upd_statement_from='last888',update_ts=CURRENT_TIMESTAMP

		--	select * from #formula_breakdown
		--select --child_func.child_func_id,
		--parent_func.*
				from  
				(
					SELECT child.[parent_level_func_sno] parent_id 
					,from_index_no =max(case when child.arg_no_for_next_func=1 then child.[parent_level_func_sno]+1 else 0 end),
									to_index_no =max(case when child.arg_no_for_next_func=1 then   999999999 else child.[parent_level_func_sno]-1   end)
					from #formula_breakdown child  inner join #formula_breakdown parent on child.parent_level_func_sno=parent.level_func_sno
					where child.[parent_level_func_sno] is not null and parent.arg1 is null and parent.arg2 is null
					and	parent.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')	
						and child.[parent_level_func_sno]<>@op_index_no
					group by child.[parent_level_func_sno] having count(1)=1
								
				) parent_func
				cross apply
				(
					select top(1)	
						[level_func_sno] child_func_id
								
					from #formula_breakdown 
						where level_func_sno between parent_func.from_index_no and parent_func.to_index_no
						and [parent_level_func_sno] is  null
						order by [level_func_sno]
				) child_func

				inner join #formula_breakdown a on a.level_func_sno=child_func.child_func_id
				and	a.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
				and a.[level_func_sno]<>@op_index_no 


			end



--handle  operand is derived from previous operator result (opertor that have only one operand (function id in parent_function has only one record.). if till exist null in parent function id
			--select * from #formula_breakdown
			--return
		
		
			while 1=1  ---fb.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
			begin

			--return
			--select	@op_index_no
				truncate table #formula_breakdown_eff
				--select @from_range

				if object_id('tempdb..#parent_only_one') is not null
				drop table #parent_only_one

					
				select p.parent_id,a.formula_level,p.child_arg_no arg_no_for_next_func 
				into #parent_only_one 
				from #formula_breakdown a
				inner join (
					select child.[parent_level_func_sno] parent_id,max(child.arg_no_for_next_func) child_arg_no
					from #formula_breakdown child  inner join #formula_breakdown parent on child.parent_level_func_sno=parent.level_func_sno
					and child.[parent_level_func_sno] is not null and parent.arg1 is null and parent.arg2 is null
					and	parent.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')	
						--and [parent_level_func_sno]<>@op_index_no
					group by child.[parent_level_func_sno] having count(1)=1
					union all
					select parent.[level_func_sno] parent_id,case when parent.arg1 is null then 2 else 1 end child_arg_no ---parent operator having any of arg1 or arg2 have constant value
					from #formula_breakdown parent left join #formula_breakdown child on child.parent_level_func_sno=parent.level_func_sno
					where child.level_func_sno is  null
					and ( parent.arg1 is not null or parent.arg2 is not null) and not ( parent.arg1 is not null and parent.arg2 is not null)
						and	parent.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')	
				) p on a.level_func_sno=p.parent_id
					
					
					--select * from #parent_only_one
					--select * from #formula_breakdown where  level_func_sno in (120,148)

				if not exists(select *   from  
				(
					select top(1) * from #parent_only_one order by formula_level desc
								
				) parent_func
				cross apply
				(
					select top(1)	[level_func_sno] child_func_id
					from #formula_breakdown 
						where  --level_func_sno between parent_func.from_index_no and parent_func.to_index_no
						formula_level>parent_func.formula_level
						and [parent_level_func_sno] is  null
						and	func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
						order by formula_level desc
				) child_func
				inner join #formula_breakdown a on a.level_func_sno=child_func.child_func_id
				and	a.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>'))  break

				
				UPDATE top(1) #formula_breakdown set [arg_no_for_next_func]= case when parent_func.arg_no_for_next_func=2 then 1 ELSE 2 end 
					,[parent_level_func_sno]=parent_func.parent_id,upd_statement_from='supper88',update_ts=CURRENT_TIMESTAMP

		--	select * from #formula_breakdown
		--select child_func.child_func_id,
		--parent_func.*
				from  
				(
					select top(1)
					 * from #parent_only_one order by formula_level desc
								
				) parent_func
				cross apply
				(
					select top(1)	[level_func_sno] child_func_id
					from #formula_breakdown 
						where  --level_func_sno between parent_func.from_index_no and parent_func.to_index_no
						formula_level>parent_func.formula_level
						and [parent_level_func_sno] is  null
						and	func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
						order by formula_level desc
				) child_func

				inner join #formula_breakdown a on a.level_func_sno=child_func.child_func_id
				and	a.func_name  IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
				--and a.[level_func_sno]<>@op_index_no 

			end

--*/

			--SELECT @already_arg_no= [arg_no_for_next_func] from #formula_breakdown WHERE [parent_level_func_sno]=@op_index_no  and [parent_level_func_sno] is not null
			--IF @already_arg_no IS NOT NULL
			--BEGIN 

			--	UPDATE #formula_breakdown set [arg_no_for_next_func]= case when @already_arg_no=2 then 1 ELSE 2 end 
			--		,[parent_level_func_sno]=@op_index_no,upd_statement_from='upd005'
			--		WHERE [parent_level_func_sno] IS  NULL AND  [level_func_sno]<>@op_index_no
			--				 AND [level_func_sno] between  @from_range AND @to_range AND formula_level>0
				
			--	--and	func_name NOT IN ( '^','%','/','*','+','-','<','<=','=','>','>=','<>')
			--END

			--select @func_loop
		--	set @func_loop=@func_loop+1
		--end --loop for 5 times
	END	
--------------------------------------------------------------------------------------------------------------------------------------------------

-------------------------------------------------------------------------
---end of handliing operator in function or parenthesis
--------------------------------------------------------------------------
IF @func_type='function'
	GOTO function_level
else if @func_type='subexpression'
begin
	--select * from #formula_breakdown
	GOTO subexpression_level
end

--select * from	#formula_breakdown
