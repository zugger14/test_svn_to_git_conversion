{"version":3,"sources":["/source/gchart_renderers.coffee"],"names":[],"mappings":"CAAA,WAAA,GAAA,IAAA,EAAiB,SAAC,GACd,MAAqB,gBAAlB,UAAgD,gBAAjB,QAC9B,EAAY,QAAQ,WACC,kBAAjB,SAAgC,OAAO,IAC3C,QAAQ,UAAW,GAGnB,EAAY,UAEL,SAAC,GAEZ,GAAA,SAAA,GAAkB,SAAC,EAAW,SAAiB,UAAC,EAAW,GACvD,GAAA,GAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,EAAA,CAiBA,KAjBA,GACI,eACI,GAAI,KACJ,GAAI,OAEZ,EAAO,EAAE,OAAO,EAAU,GAE1B,EAAU,EAAU,aACiB,IAAlB,EAAQ,QAA3B,EAAQ,SACR,EAAU,EAAU,aACiB,IAAlB,EAAQ,QAA3B,EAAQ,SAER,EAAA,yBAAW,KAAA,EAAA,EAAA,EAAA,EAAA,OAAA,EAAA,EAAA,WAAA,EAAA,KAAA,EAAE,KAAK,kBAClB,EAAQ,QAAQ,IAEhB,EAAkB,EAClB,GAAa,GACb,EAAA,EAAA,EAAA,EAAA,OAAA,EAAA,EAAA,IAAA,CAGI,WAFA,GAAO,EAAO,KAAK,MACnB,GAAmB,EAAI,GAAG,OAC1B,EAAA,EAAA,EAAA,EAAA,OAAA,EAAA,EAAA,WACI,EAAM,EAAU,cAAc,EAAQ,GAElC,EAAI,KADL,MAAA,EAAA,QACU,EAAI,QACH,KAClB,GAAU,KAAK,GAEnB,EAAQ,EAAa,EAAU,gBACxB,EAAU,SAAS,OAAa,IAAG,EAAU,SAAS,KAAK,MAAM,IAAQ,IAChF,EAAa,EAAU,SAAS,KAAK,KAC+B,KAAd,IAAtD,GAAU,IAAG,EAAK,cAAc,GAAG,IAAG,GACtC,EAAe,EAAU,SAAS,KAAK,KACiC,KAAhB,IAAxD,GAAU,IAAG,EAAK,cAAc,GAAG,IAAG,GAEtC,GACI,MAAO,EAAE,QAAQ,QAAU,IAC3B,OAAQ,EAAE,QAAQ,SAAW,IAC7B,MAAO,EACP,OAAQ,MAAO,EAAY,YAAa,EAAkB,IAC1D,OAAQ,MAAO,IAEO,IAAvB,EAAU,GAAG,QAAoC,KAApB,EAAU,GAAG,KACzC,EAAQ,QAAS,SAAU,QAE/B,KAAA,IAAA,UAAA,EAAQ,GAAK,CAYb,OAVA,GAAY,OAAO,cAAc,iBAAiB,GAElD,EAAS,EAAE,SAAS,KAAI,MAAO,OAAQ,OAAQ,SAC/C,EAAc,GAAA,QAAO,cAAc,cAAc,UAAA,EAAW,UAAA,EAAW,QAAA,IACvE,EAAQ,KAAK,EAAO,IACpB,EAAO,KAAK,WAAY,WACpB,GAAA,SAAA,GAAa,GAAA,QAAO,cAAc,YAClC,OAAO,cAAc,OAAO,YAAY,EAAQ,KAAM,iBAClD,GAAO,kBAAkB,KAAK,EAAO,MACzC,EAAO,WAAW,KACf,IAEX,EAAE,eAAe,kBACb,aAAc,EAAgB,aAC9B,YAAa,EAAgB,eAC7B,oBAAqB,EAAgB,eAAe,WAAW,IAC/D,aAAc,EAAgB,aAAa,WAAW","file":"gchart_renderers.min.js","sourcesContent":["callWithJQuery = (pivotModule) ->\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\n        pivotModule require(\"jquery\")\n    else if typeof define is \"function\" and define.amd # AMD\n        define [\"jquery\"], pivotModule\n    # Plain browser env\n    else\n        pivotModule jQuery\n        \ncallWithJQuery ($) ->\n\n    makeGoogleChart = (chartType, extraOptions) -> (pivotData, opts) ->\n        defaults =\n            localeStrings:\n                vs: \"vs\"\n                by: \"by\"\n\n        opts = $.extend defaults, opts\n\n        rowKeys = pivotData.getRowKeys()\n        rowKeys.push [] if rowKeys.length == 0\n        colKeys = pivotData.getColKeys()\n        colKeys.push [] if colKeys.length == 0\n\n        headers = (h.join(\"-\") for h in rowKeys)\n        headers.unshift \"\"\n\n        numCharsInHAxis = 0\n        dataArray = [headers]\n        for colKey in colKeys\n            row = [colKey.join(\"-\")]\n            numCharsInHAxis += row[0].length\n            for rowKey in rowKeys\n                agg = pivotData.getAggregator(rowKey, colKey)\n                if agg.value()?\n                    row.push agg.value()\n                else row.push null\n            dataArray.push row\n\n        title = vAxisTitle = pivotData.aggregatorName+ \n            if pivotData.valAttrs.length then \"(#{pivotData.valAttrs.join(\", \")})\" else \"\"\n        hAxisTitle = pivotData.colAttrs.join(\"-\")\n        title += \" #{opts.localeStrings.vs} #{hAxisTitle}\" if hAxisTitle != \"\"\n        groupByTitle = pivotData.rowAttrs.join(\"-\")\n        title += \" #{opts.localeStrings.by} #{groupByTitle}\" if groupByTitle != \"\"\n\n        options = \n            width: $(window).width() / 1.4\n            height: $(window).height() / 1.4\n            title: title\n            hAxis: {title: hAxisTitle, slantedText: numCharsInHAxis > 50}\n            vAxis: {title: vAxisTitle}\n\n        if dataArray[0].length == 2 and dataArray[0][1] ==  \"\"\n            options.legend = position: \"none\"\n\n        options[k] = v for k, v of extraOptions\n\n        dataTable = google.visualization.arrayToDataTable(dataArray)\n\n        result = $(\"<div>\").css(width: \"100%\", height: \"100%\")\n        wrapper = new google.visualization.ChartWrapper {dataTable, chartType, options}\n        wrapper.draw(result[0])    \n        result.bind \"dblclick\", -> \n            editor = new google.visualization.ChartEditor()\n            google.visualization.events.addListener editor, 'ok', -> \n                editor.getChartWrapper().draw(result[0])\n            editor.openDialog(wrapper)\n        return result\n\n    $.pivotUtilities.gchart_renderers = \n        \"Line Chart\": makeGoogleChart(\"LineChart\")\n        \"Bar Chart\": makeGoogleChart(\"ColumnChart\")\n        \"Stacked Bar Chart\": makeGoogleChart(\"ColumnChart\", isStacked: true)\n        \"Area Chart\": makeGoogleChart(\"AreaChart\", isStacked: true)\n"],"sourceRoot":"/source/"}